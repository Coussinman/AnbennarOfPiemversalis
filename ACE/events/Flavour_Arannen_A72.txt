namespace = flavor_arannen

country_event = {
	id = flavor_arannen.1
	title = flavor_arannen.1.t
	desc = flavor_arannen.1.d
	picture = COUNTRY_COLLAPSE_eventPicture
	fire_only_once = yes
	is_triggered_only = yes

	option = {
		name = flavor_arannen.1.a
		set_country_flag = wexonard_anbennar_group
		custom_tooltip = A30_update_wexonard_tooltip
		hidden_effect = {
			update_entire_culture_foreign = {
				culture = wexonard
			}
		}
		anb_add_accepted_culture_or_dip_power = {
			culture = wexonard_new
			free = yes
		}
	}

	option = {
		name = flavor_arannen.1.b
		custom_tooltip = A30_update_wexonard_tooltip2
		hidden_effect = {
			every_owned_province = {
				limit = {
					culture = wexonard
				}
				add_province_modifier = {
					name = wexonard_integration2
					duration = -1
				}
			}
		}
		tooltip = {
			add_province_modifier = {
				name = wexonard_integration2
				duration = -1
			}
		}
	}
}

country_event = {
	id = flavor_arannen.2
	title = flavor_arannen.2.t
	desc = flavor_arannen.2.d
	picture = COUNTRY_COLLAPSE_eventPicture
	fire_only_once = yes
	is_triggered_only = yes

	option = {
		set_country_flag = A72_tellum
		name = flavor_arannen.2.a

		add_dip_power = -100
		add_treasury = -200

		inherit = A86
		
		add_government_reform = arannen_crier_council
		# if = {
		# 	limit = {
		# 		reform_level = 3
		# 	}
		# 	change_government_reform_progress = 140
		# }
		
		emperor = {
			add_opinion = {
				who = ROOT
				modifier = subjugated_free_city
			}
		}

	}

	option = {
		name = flavor_arannen.2.b

		add_core = 417
	}
}

country_event = {
	id = flavor_arannen.3
	title = flavor_arannen.3.t
	desc = flavor_arannen.3.d
	picture = COUNTRY_COLLAPSE_eventPicture
	fire_only_once = yes
	is_triggered_only = yes

	immediate = {
		kryzzar_release = yes
	}

	option = {
		name = flavor_arannen.3.a
		set_country_flag = kryzzar_released
		ROOT = {
			declare_war_with_cb = {
				casus_belli = cb_civ_vs_monster
				who = AC7
			}
		}
	}
}

country_event = {
	id = flavor_arannen.4
	title = flavor_arannen.4.t
	desc = flavor_arannen.4.d
	picture = COUNTRY_COLLAPSE_eventPicture
	fire_only_once = yes
	trigger = {
		AC7 = {
			exists = no
		}
		has_country_flag = kryzzar_released
	}

	option = {
		name = flavor_arannen.4.a
		every_owned_province = {
			limit = {
				region = daravans_folly_region
			}
			add_province_modifier = {
				name = folly_prosperity
				duration = -1
			}
		}
		add_stability = 1
		add_adm_power = 100

	}
}

country_event = {
	id = flavor_arannen.5
	title = flavor_arannen.5.t
	desc = flavor_arannen.5.d
	picture = COUNTRY_COLLAPSE_eventPicture

	trigger = {
		any_owned_province = {
			had_province_flag = {
				flag = mine_salt
				days = 365
			}
		}
	}


	immediate = {
		hidden_effect = {
			clr_country_flag = prospecting_for_salt_flag
			random_owned_province = {
				limit = { 
					had_province_flag = {
						flag = mine_salt
						days = 365
					}
				}
				save_event_target_as = salt_event
				clr_province_flag = mine_salt	
				if = {
					limit = {
						NOT = {
							trade_goods = salt
						}
					}
					change_trade_goods = salt
				}
			}
		}
	}


	option = {
		name = flavor_arannen.5.a

		goto = salt_event
	}

}

province_event = {
	id = flavor_arannen.6
	title = flavor_arannen.6.t
	desc = flavor_arannen.6.d
	picture = COUNTRY_COLLAPSE_eventPicture
	is_triggered_only = yes

	goto = ROOT

	is_triggered_only = yes

	immediate = {
		hidden_effect = {
			remove_province_modifier = salt_road_under_construction
			add_permanent_province_modifier = {
				name = salt_road
				duration = -1
			}
			salt_road = { salt_road_select_next_province = yes }
			event_target:salt_road_next_province = {
				if = {
					limit = {
						NOT = { has_province_modifier = salt_road }
					}
					add_permanent_province_modifier = { name = salt_road_under_construction duration = -1 }
					province_event = { id = flavor_arannen.6 days = 90 random = 90 }
				}
			}
		}
	}

	#The road is built!
	option = {
		name = flavor_arannen.6.a
		ai_chance = { factor = 1 }
		owner = { add_prestige_excess_to_splendour_effect = { VAL = 5 } }
	}
}

country_event = {
	id = flavor_arannen.7
	title = flavor_arannen.7.t
	desc = flavor_arannen.7.d
	picture = COUNTRY_COLLAPSE_eventPicture
	is_triggered_only = yes
	fire_only_once = yes

	option = {
		name = flavor_arannen.7.a

		custom_tooltip = flavor_arannen.7.a.tt
		Z06 = {
			override_country_name = WISKPKINGS_REALM
			set_country_flag = wispkings_realm
			change_government = theocracy
			add_government_reform = wispkings_realm
			force_add_ruler_personality = { personality = mage_personality }
		}
	}

	option = {
		name = flavor_arannen.7.b
		custom_tooltip = flavor_arannen.7.b.tt
		create_war_wizard_effect = yes
	}
}

country_event = {
	id = flavor_arannen.8
	title = flavor_arannen.8.t
	desc = flavor_arannen.8.d
	picture = COUNTRY_COLLAPSE_eventPicture
	is_triggered_only = yes
	fire_only_once = yes

	immediate = {
		A59 = {
			declare_war_with_cb = {
				casus_belli = cb_claim_throne
				who = A60
			}
			hidden_effect = {
				every_ally = {
					join_all_offensive_wars_of = A59
				}
			}
		}
		
		hidden_effect = {
			emperor = {
				country_event = {
					id = flavor_arannen.16
					days = 1
				}
			}
		}
	}


	option = {
		name = flavor_arannen.8.a
		custom_tooltip = flavor_arannen.8.a.tt
		add_country_modifier = {
			name = A72_corvurian_surprise
			duration = 1825
		}
	}
}

country_event = {
	id = flavor_arannen.9
	title = flavor_arannen.9.t
	desc = flavor_arannen.9.d
	picture = COUNTRY_COLLAPSE_eventPicture
	is_triggered_only = yes
	fire_only_once = yes

	option = {
		name = flavor_arannen.9.a
		set_dynasty = "síl Vivin"

		custom_tooltip = flavor_arannen.9.a.tt
	}

	option = {
		name = flavor_arannen.9.b
		set_dynasty = "síl Vivin"

		custom_tooltip = flavor_arannen.9.b.tt
		set_country_flag = has_vampires_estate
		hidden_effect = {
			country_event = { id = vampires_estate_events.12 days = 2 }
		}

		custom_tooltip = flavor_arannen.9.a.tt
	}
}

country_event = {
	id = flavor_arannen.10
	title = flavor_arannen.10.t
	desc = flavor_arannen.10.d
	picture = COUNTRY_COLLAPSE_eventPicture
	is_triggered_only = yes

	trigger = {
		has_reform = wispkings_realm
	}

	option = {
		name = flavor_arannen.10.a
		define_ruler = {
			max_random_adm = 6
			max_random_dip = 6
			max_random_mil = 6
		}
		add_ruler_personality = mage_personality
	}
}

country_event = {
	id = flavor_arannen.11
	title = flavor_arannen.11.t
	desc = flavor_arannen.11.d
	picture = COUNTRY_COLLAPSE_eventPicture
	trigger = {
		has_country_flag = A72_tellum_insult
		has_reform = arannen_crier_council
	}
	mean_time_to_happen = {
		days = 7305
	}
	option = {
		name = flavor_arannen.11.a
		random_list = {
			50 = {
				add_prestige = 10
				random_rival_country = {
					ROOT = {
						reverse_add_opinion = {
							who = PREV
							modifier = scornfully_insulted
						}
					}
				}
			}
			50 = {
				add_prestige = -10
				random_ally = {
					add_opinion = {
						who = ROOT
						modifier = scornfully_insulted
					}
				}
			}
		}
	}
}

country_event = {
	id = flavor_arannen.12
	title = flavor_arannen.12.t
	desc = flavor_arannen.12.d
	picture = COUNTRY_COLLAPSE_eventPicture
	is_triggered_only = yes 
	major = yes
	major_trigger = {
		OR = {
			war_with = emperor
			any_war_enemy_country = {
				war_with = emperor
			}
		}
	}
	
	option = {
		name = flavor_arannen.12.a
		
		ai_chance = {
			factor = 1
		}
		
		join_all_defensive_wars_of = emperor
		
		add_power_projection_mission = { amount = 20 }
		
		add_dip_power = 50
	}
	
	option = {
		name = flavor_arannen.12.b
		
		ai_chance = {
			factor = 0
		}
		
		add_war_exhaustion = -0.5
	}
}

country_event = {
	id = flavor_arannen.13
	title = flavor_arannen.13.t
	desc = flavor_arannen.13.d
	picture = COUNTRY_COLLAPSE_eventPicture
	is_triggered_only = yes
	fire_only_once = yes

	option = {
		name = flavor_arannen.13.a
		trigger = {
			any_subject_country = {
				capital_scope = {
					region = esmaria_region
				}
			}
		}
		random_subject_country = {
			limit = {
				capital_scope = {
					region = esmaria_region
				}
			}
			capital_scope = {
				add_permanent_province_modifier = {
					name = the_summer_court
					duration = -1
				}
			}
			change_tag = Z46
			define_ruler = {
				dynasty = "síl Vivin-Esmaraine"
			}
		}
		create_subject = {
			subject_type = vassal
			subject = Z46
		}
	}

	option = {
		name = flavor_arannen.13.b
		trigger = {
			any_ally = {
				capital_scope = {
					region = esmaria_region
				}
				total_development = 150
			}
		}
		
		random_ally = {
			limit = {
				capital_scope = {
					region = esmaria_region
				}
				total_development = 150
			}
			capital_scope = {
				add_permanent_province_modifier = {
					name = the_summer_court
					duration = -1
				}
			}
			change_tag = Z46
			define_ruler = {
				dynasty = "síl Vivin-Esmaraine"
			}
		}
		create_subject = {
			subject_type = vassal
			subject = Z46
		}
		
	}

	option = {
		name = flavor_arannen.13.c
		trigger = {
			901 = {
				owned_by = ROOT
			}
		}
		901 = {
			add_permanent_province_modifier = {
				name = the_summer_court
				duration = -1
			}
		}
	}

	option = {
		name = flavor_arannen.13.f
		trigger = {
			280 = {
				owned_by = ROOT
			}
		}
		280 = {
			add_permanent_province_modifier = {
				name = the_summer_court
				duration = -1
			}
		}
	}

	option = {
		name = flavor_arannen.13.e
		trigger = {
			275 = {
				owned_by = ROOT
			}
		}
		275 = {
			add_permanent_province_modifier = {
				name = the_summer_court
				duration = -1
			}
		}
	}

	option = {
		name = flavor_arannen.13.g
		trigger = {
			271 = {
				owned_by = ROOT
			}
		}
		271 = {
			add_permanent_province_modifier = {
				name = the_summer_court
				duration = -1
			}
		}
	}

	option = {
		name = flavor_arannen.13.h
		trigger = {
			266 = {
				owned_by = ROOT
			}
		}
		266 = {
			add_permanent_province_modifier = {
				name = the_summer_court
				duration = -1
			}
		}
	}
}

country_event = {
	id = flavor_arannen.14
	title = flavor_arannen.14.t
	desc = flavor_arannen.14.d
	picture = COUNTRY_COLLAPSE_eventPicture
	is_triggered_only = yes
	fire_only_once = yes

	option = {
		name = flavor_arannen.14.a
		add_country_modifier = {
			name = copper_arty
			duration = -1
		}
	}

	option = {
		name = flavor_arannen.14.b
		add_country_modifier = {
			name = iron_arty
			duration = -1
		}
	}

}

country_event = {
	id = flavor_arannen.15
	title = flavor_arannen.15.t
	desc = flavor_arannen.15.d
	picture = COUNTRY_COLLAPSE_eventPicture
	is_triggered_only = yes
	fire_only_once = yes

	option = {
		name = flavor_arannen.15.a
		custom_tooltip = flavor_arannen.1.a.tt
		set_country_flag = vivin_arannen_friendship
		add_trust = {
			who = A60
			value = 10
		}
		920 = {
			remove_core = ROOT
			add_core = A60
		}
		321 = {
			remove_claim = ROOT
			add_core = A60
		}
	}

	option = {
		name = flavor_arannen.15.b
		add_country_modifier = {
			name = conquest_doctrine
			duration = 3650
		}
		
		ashfields_area = {
			add_claim = A60
		}
		add_trust = {
			who = A60
			value = -10
		}
		remove_historical_friend = A60
		A60 = {
			remove_historical_friend = ROOT
		}
		break_marriage = A60
		break_alliance = A60
	}

}

country_event = {
	id = flavor_arannen.16
	title = flavor_arannen.16.t
	desc = flavor_arannen.16.d
	picture = COUNTRY_COLLAPSE_eventPicture
	is_triggered_only = yes
	fire_only_once = yes

	option = {
		name = flavor_arannen.16.a
		emperor = {
			white_peace = A59
			every_ally = {
				limit = {
					NOT = {
						OR = {
							tag = A72
							was_tag = A72
						}
					}
				}
				white_peace = A59
			}
		}
	}

}

country_event = {
	id = flavor_arannen.17
	title = flavor_arannen.17.t
	desc = flavor_arannen.17.d
	picture = COUNTRY_COLLAPSE_eventPicture
	is_triggered_only = yes
	fire_only_once = yes

	option = {
		name = flavor_arannen.17.a
		set_estate_privilege = estate_nobles_sina_dharcel_nobility
		add_dip_power = -100
		inherit = Z06
	}

	option = {
		name = flavor_arannen.17.b
		add_historical_friend = Z06
		Z06 = {
			add_historical_friend = ROOT
			add_country_modifier = {
				name = shield_of_arannen
				duration = -1
			}
		}
	}
}