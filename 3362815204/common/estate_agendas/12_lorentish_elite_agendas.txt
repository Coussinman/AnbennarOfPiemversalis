estate_lorentish_elite_build_temple_in_y = {
	can_select = {
		adm_tech = 4
		any_owned_province = {
			OR = {
				region = lencenor_region
				region = west_dameshead_region
			}
			is_state_core = root
			NOT = { has_building = cathedral }
			OR = {
				AND = {
					NOT = { has_building = temple }
					num_free_building_slots = 1
				}
				AND = {
					ROOT = { adm_tech = 19 }
					has_building = temple
				}
			}
		}
	}
	selection_weight = {
		factor = 1
		modifier = {
			factor = 0.65
			NOT = {
				any_owned_province = {
					OR = {
						region = lencenor_region
						region = west_dameshead_region
					}
					is_state_core = root
					base_tax = 4
					NOT = { has_building = cathedral }
					OR = {
						AND = {
							NOT = { has_building = temple }
							num_free_building_slots = 1
						}
						AND = {
							ROOT = { adm_tech = 19 }
							has_building = temple
						}
					}
				}
			}
		}
		modifier = {
			factor = 1.2
			any_owned_province = {
				OR = {
					region = lencenor_region
					region = west_dameshead_region
				}
				is_state_core = root
				base_tax = 7
				NOT = { has_building = cathedral }
				OR = {
					AND = {
						NOT = { has_building = temple }
						num_free_building_slots = 1
					}
					AND = {
						ROOT = { adm_tech = 19 }
						has_building = temple
					}
				}
			}
		}
		modifier = {
			factor = 2
			NOT = {
				crown_land_share = 15
			}
		}
	}
	pre_effect = {
		set_variable = {
			which = estate_lorentish_elite_build_temple_in_y_var
			value = 0
		}
		random_owned_province = {
			limit = {
				OR = {
					region = lencenor_region
					region = west_dameshead_region
				}
				is_state_core = root
				NOT = { has_building = cathedral }
				OR = {
					AND = {
						NOT = { has_building = temple }
						num_free_building_slots = 1
					}
					AND = {
						ROOT = { adm_tech = 19 }
						has_building = temple
					}
				}
			}
			save_event_target_as = agenda_province
		}
		random_owned_province = {
			limit = {
				OR = {
					region = lencenor_region
					region = west_dameshead_region
				}
				is_state_core = root
				base_tax = 4
				NOT = { has_building = cathedral }
				OR = {
					AND = {
						NOT = { has_building = temple }
						num_free_building_slots = 1
					}
					AND = {
						ROOT = { adm_tech = 19 }
						has_building = temple
					}
				}
			}
			save_event_target_as = agenda_province
		}
		random_owned_province = {
			limit = {
				OR = {
					region = lencenor_region
					region = west_dameshead_region
				}
				is_state_core = root
				base_tax = 7
				NOT = { has_building = cathedral }
				OR = {
					AND = {
						NOT = { has_building = temple }
						num_free_building_slots = 1
					}
					AND = {
						ROOT = { adm_tech = 19 }
						has_building = temple
					}
				}
			}
			save_event_target_as = agenda_province
		}
		event_target:agenda_province = {
			if = {
				limit = {
					NOT = { has_building = temple }
				}
				ROOT = {
					set_variable = {
						which = estate_lorentish_elite_build_temple_in_y_var
						value = 1
					}
				}
			}
			else = {
				ROOT = {
					set_variable = {
						which = estate_lorentish_elite_build_temple_in_y_var
						value = 2
					}
				}
			}
		}
	}
	provinces_to_highlight = {
		province_id = event_target:agenda_province
	}
	fail_if = {
		event_target:agenda_province = {
			NOT = { owned_by = root }
		}
	}
	task_requirements = {
		if = {
			limit = {
				has_estate_agenda_auto_completion = {
					estate = estate_lorentish_elite
				}
			}
			has_estate_agenda_auto_completion = {
				estate = estate_lorentish_elite
			}
		}
		else = {
			if = {
				limit = {
					check_variable = {
						which = estate_lorentish_elite_build_temple_in_y_var
						value = 2
					}
				}
				event_target:agenda_province = {
					has_building = cathedral
				}
			}
			else = {
				event_target:agenda_province = {
					OR = {
						has_building = temple
						has_building = cathedral
					}
				}
			}
		}
	}
	task_completed_effect = {
		on_completed_agenda_effect = {
			estate = estate_lorentish_elite
		}
		add_estate_loyalty = {
			estate = estate_lorentish_elite
			loyalty = 10
		}
		if = {
			limit = {
				NOT = { crown_land_share = 15 }
				estate_territory = {
					estate = estate_lorentish_elite
					territory = 10
				}
				estate_not_has_exempt_from_seize_land_privilege = { estate = estate_lorentish_elite }
			}
			take_estate_land_share_small = { estate = estate_lorentish_elite }
		}
		else = {
			event_target:agenda_province = {
				add_base_tax = 1
			}
		}
	}
	failing_effect = {
		on_failed_agenda_effect = yes
		clr_auto_complete_flag = yes
		event_target:agenda_province = {
			if = {
				limit = { owned_by = root }
				add_named_unrest = {
					name = local_clergy_displeased
					value = 5
				}
			}
		}
		add_estate_loyalty_modifier = {
			estate = estate_lorentish_elite
			desc = EST_VAL_AGENDA_DENIED
			loyalty = -5
			duration = 7300
		}
	}
}

estate_lorentish_elite_build_army_building_in_y = {
	can_select = {
		mil_tech = 6
		any_owned_province = {
			OR = {
				region = lencenor_region
				region = west_dameshead_region
			}
			is_state_core = root
			OR = {
				NOT = { has_building = training_fields }
				NOT = { has_building = conscription_center }
			}
			OR = {
				AND = {
					NOT = { has_building = barracks }
					num_free_building_slots = 1
				}
				AND = {
					ROOT = { mil_tech = 8 }
					NOT = { has_building = regimental_camp }
					num_free_building_slots = 1
				}
				AND = {
					NOT = { has_building = training_fields }
					ROOT = { mil_tech = 16 }
					OR = {
						has_building = barracks
						num_free_building_slots = 1
					}
				}
				AND = {
					NOT = { has_building = conscription_center }
					ROOT = { mil_tech = 22 }
					OR = {
						has_building = regimental_camp
						num_free_building_slots = 1
					}
				}
			}
		}
	}
	selection_weight = {
		factor = 1
		modifier = {
			factor = 0.65
			NOT = {
				any_owned_province = {
					OR = {
						region = lencenor_region
						region = west_dameshead_region
					}
					is_state_core = root
					base_manpower = 3
					OR = {
						NOT = { has_building = training_fields }
						NOT = { has_building = conscription_center }
					}
					OR = {
						AND = {
							NOT = { has_building = barracks }
							num_free_building_slots = 1
						}
						AND = {
							ROOT = { mil_tech = 8 }
							NOT = { has_building = regimental_camp }
							num_free_building_slots = 1
						}
						AND = {
							NOT = { has_building = training_fields }
							ROOT = { mil_tech = 16 }
							OR = {
								has_building = barracks
								num_free_building_slots = 1
							}
						}
						AND = {
							NOT = { has_building = conscription_center }
							ROOT = { mil_tech = 22 }
							OR = {
								has_building = regimental_camp
								num_free_building_slots = 1
							}
						}
					}
				}
			}
		}
		modifier = {
			factor = 1.2
			any_owned_province = {
				OR = {
					region = lencenor_region
					region = west_dameshead_region
				}
				is_state_core = root
				base_manpower = 6
				OR = {
					NOT = { has_building = training_fields }
					NOT = { has_building = conscription_center }
				}
				OR = {
					AND = {
						NOT = { has_building = barracks }
						num_free_building_slots = 1
					}
					AND = {
						ROOT = { mil_tech = 8 }
						NOT = { has_building = regimental_camp }
						num_free_building_slots = 1
					}
					AND = {
						NOT = { has_building = training_fields }
						ROOT = { mil_tech = 16 }
						OR = {
							has_building = barracks
							num_free_building_slots = 1
						}
					}
					AND = {
						NOT = { has_building = conscription_center }
						ROOT = { mil_tech = 22 }
						OR = {
							has_building = regimental_camp
							num_free_building_slots = 1
						}
					}
				}
			}
		}
		modifier = {
			factor = 2
			NOT = {
				crown_land_share = 15
			}
		}
	}
	pre_effect = {
		set_variable = {
			which = estate_lorentish_elite_build_army_building_in_y_var
			value = 0
		}
		random_owned_province = {
			limit = {
				OR = {
					region = lencenor_region
					region = west_dameshead_region
				}
				is_state_core = root
				OR = {
					NOT = { has_building = training_fields }
					NOT = { has_building = conscription_center }
				}
				OR = {
					AND = {
						NOT = { has_building = barracks }
						num_free_building_slots = 1
					}
					AND = {
						ROOT = { mil_tech = 8 }
						NOT = { has_building = regimental_camp }
						num_free_building_slots = 1
					}
					AND = {
						NOT = { has_building = training_fields }
						ROOT = { mil_tech = 16 }
						OR = {
							has_building = barracks
							num_free_building_slots = 1
						}
					}
					AND = {
						NOT = { has_building = conscription_center }
						ROOT = { mil_tech = 22 }
						OR = {
							has_building = regimental_camp
							num_free_building_slots = 1
						}
					}
				}
			}
			save_event_target_as = agenda_province
		}
		random_owned_province = {
			limit = {
				OR = {
					region = lencenor_region
					region = west_dameshead_region
				}
				is_state_core = root
				base_manpower = 3
				OR = {
					NOT = { has_building = training_fields }
					NOT = { has_building = conscription_center }
				}
				OR = {
					AND = {
						NOT = { has_building = barracks }
						num_free_building_slots = 1
					}
					AND = {
						ROOT = { mil_tech = 8 }
						NOT = { has_building = regimental_camp }
						num_free_building_slots = 1
					}
					AND = {
						NOT = { has_building = training_fields }
						ROOT = { mil_tech = 16 }
						OR = {
							has_building = barracks
							num_free_building_slots = 1
						}
					}
					AND = {
						NOT = { has_building = conscription_center }
						ROOT = { mil_tech = 22 }
						OR = {
							has_building = regimental_camp
							num_free_building_slots = 1
						}
					}
				}
			}
			save_event_target_as = agenda_province
		}
		random_owned_province = {
			limit = {
				OR = {
					region = lencenor_region
					region = west_dameshead_region
				}
				is_state_core = root
				base_manpower = 6
				OR = {
					NOT = { has_building = training_fields }
					NOT = { has_building = conscription_center }
				}
				OR = {
					AND = {
						NOT = { has_building = barracks }
						num_free_building_slots = 1
					}
					AND = {
						ROOT = { mil_tech = 8 }
						NOT = { has_building = regimental_camp }
						num_free_building_slots = 1
					}
					AND = {
						NOT = { has_building = training_fields }
						ROOT = { mil_tech = 16 }
						OR = {
							has_building = barracks
							num_free_building_slots = 1
						}
					}
					AND = {
						NOT = { has_building = conscription_center }
						ROOT = { mil_tech = 22 }
						OR = {
							has_building = regimental_camp
							num_free_building_slots = 1
						}
					}
				}
			}
			save_event_target_as = agenda_province
		}
		event_target:agenda_province = {
			if = {
				limit = {
					NOT = { has_building = training_fields }
					ROOT = { mil_tech = 16 }
					OR = {
						num_free_building_slots = 1
						has_building = barracks
					}
				}
				ROOT = {
					set_variable = {
						which = estate_lorentish_elite_build_army_building_in_y_var
						value = 4
					}
				}
			}
			else_if = {
				limit = {
					NOT = { has_building = barracks }
					NOT = { has_building = training_fields }
					num_free_building_slots = 1
				}
				ROOT = {
					set_variable = {
						which = estate_lorentish_elite_build_army_building_in_y_var
						value = 3
					}
				}
			}
			else_if = {
				limit = {
					has_building = regimental_camp
					ROOT = { mil_tech = 22 }
				}
				ROOT = {
					set_variable = {
						which = estate_lorentish_elite_build_army_building_in_y_var
						value = 2
					}
				}
			}
			else = {
				ROOT = {
					set_variable = {
						which = estate_lorentish_elite_build_army_building_in_y_var
						value = 1
					}
				}
			}
		}
	}
	provinces_to_highlight = {
		province_id = event_target:agenda_province
	}
	fail_if = {
		event_target:agenda_province = {
			NOT = { owned_by = root }
		}
	}
	task_requirements = {
		if = {
			limit = {
				has_estate_agenda_auto_completion = {
					estate = estate_lorentish_elite
				}
			}
			has_estate_agenda_auto_completion = {
				estate = estate_lorentish_elite
			}
		}
		else = {
			if = {
				limit = {
					check_variable = {
						which = estate_lorentish_elite_build_army_building_in_y_var
						value = 4
					}
				}
				event_target:agenda_province = {
					has_building = training_fields
				}
			}
			else_if = {
				limit = {
					check_variable = {
						which = estate_lorentish_elite_build_army_building_in_y_var
						value = 3
					}
				}
				event_target:agenda_province = {
					OR = {
						has_building = barracks
						has_building = training_fields
					}
				}
			}
			else_if = {
				limit = {
					check_variable = {
						which = estate_lorentish_elite_build_army_building_in_y_var
						value = 2
					}
				}
				event_target:agenda_province = {
					has_building = conscription_center
				}
			}
			else = {
				event_target:agenda_province = {
					OR = {
						has_building = regimental_camp
						has_building = conscription_center
					}
				}
			}
		}
	}
	task_completed_effect = {
		on_completed_agenda_effect = {
			estate = estate_lorentish_elite
		}
		add_estate_loyalty = {
			estate = estate_lorentish_elite
			loyalty = 10
		}
		if = {
			limit = {
				NOT = { crown_land_share = 15 }
				estate_territory = {
					estate = estate_lorentish_elite
					territory = 10
				}
				estate_not_has_exempt_from_seize_land_privilege = { estate = estate_lorentish_elite }
			}
			take_estate_land_share_small = { estate = estate_lorentish_elite }
		}
		else = {
			event_target:agenda_province = {
				add_base_manpower = 1
			}
		}
	}
	failing_effect = {
		on_failed_agenda_effect = yes
		clr_auto_complete_flag = yes
		event_target:agenda_province = {
			if = {
				limit = { owned_by = root }
				add_named_unrest = {
					name = local_nobles_displeased
					value = 5
				}
			}
		}
		add_estate_loyalty_modifier = {
			estate = estate_lorentish_elite
			desc = EST_VAL_AGENDA_DENIED
			loyalty = -5
			duration = 7300
		}
	}
}

estate_lorentish_elite_build_fort_building_in_y = {
	can_select = {
		any_owned_province = {
			OR = {
				region = lencenor_region
				region = west_dameshead_region
			}
			OR = {
				AND = {
					NOT = { has_building = fort_15th }
					NOT = { has_building = fort_16th }
					NOT = { has_building = fort_17th }
					NOT = { has_building = fort_18th }
					num_free_building_slots = 1
					any_neighbor_province = {
						owner = {
							OR = {
								is_rival = root
								root = { is_rival = prev }
								AND = {
									is_subject_other_than_tributary_trigger = yes
									overlord = {
										OR = {
											is_rival = root
											root = { is_rival = prev }
										}
									}
								}
							}
						}
					}
					NOT = {
						any_neighbor_province = {
							owned_by = root
							OR = {
								has_building = fort_15th
								has_building = fort_16th
								has_building = fort_17th
								has_building = fort_18th
							}
						}
					}
				}
				AND = {
					NOT = { has_building = fort_15th }
					NOT = { has_building = fort_16th }
					NOT = { has_building = fort_17th }
					NOT = { has_building = fort_18th }
					num_free_building_slots = 1
					any_neighbor_province = {
						owned_by = root
						any_neighbor_province = {
							owner = {
								OR = {
									is_rival = root
									root = { is_rival = prev }
									AND = {
										is_subject_other_than_tributary_trigger = yes
										overlord = {
											OR = {
												is_rival = root
												root = { is_rival = prev }
											}
										}
									}
								}
							}
							NOT = {
								any_neighbor_province = {
									owned_by = root
									OR = {
										has_building = fort_15th
										has_building = fort_16th
										has_building = fort_17th
										has_building = fort_18th
									}
								}
							}
						}
					}
				}
				AND = {
					has_building = fort_15th
					ROOT = { mil_tech = 14 }
				}
				AND = {
					has_building = fort_16th
					ROOT = { mil_tech = 19 }
				}
				AND = {
					has_building = fort_17th
					ROOT = { mil_tech = 24 }
				}
			}
			NOT = { has_building = fort_18th }
		}
	}
	selection_weight = {
		factor = 1
		modifier = {
			factor = 1.5
			any_neighbor_country = {
				OR = {
					is_rival = root
					root = { is_rival = prev }
				}
				army_size = root
			}
		}
	}
	pre_effect = {
		set_variable = {
			which = estate_lorentish_elite_build_fort_building_in_y_var
			value = 0
		}
		random_owned_province = {
			limit = {
				OR = {
					region = lencenor_region
					region = west_dameshead_region
				}
				OR = {
					AND = {
						NOT = { has_building = fort_15th }
						NOT = { has_building = fort_16th }
						NOT = { has_building = fort_17th }
						NOT = { has_building = fort_18th }
						num_free_building_slots = 1
						any_neighbor_province = {
							owner = {
								OR = {
									is_rival = root
									root = { is_rival = prev }
									AND = {
										is_subject_other_than_tributary_trigger = yes
										overlord = {
											OR = {
												is_rival = root
												root = { is_rival = prev }
											}
										}
									}
								}
							}
						}
						NOT = {
							any_neighbor_province = {
								owned_by = root
								OR = {
									has_building = fort_15th
									has_building = fort_16th
									has_building = fort_17th
									has_building = fort_18th
								}
							}
						}
					}
					AND = {
						NOT = { has_building = fort_15th }
						NOT = { has_building = fort_16th }
						NOT = { has_building = fort_17th }
						NOT = { has_building = fort_18th }
						num_free_building_slots = 1
						any_neighbor_province = {
							owned_by = root
							any_neighbor_province = {
								owner = {
									OR = {
										is_rival = root
										root = { is_rival = prev }
										AND = {
											is_subject_other_than_tributary_trigger = yes
											overlord = {
												OR = {
													is_rival = root
													root = { is_rival = prev }
												}
											}
										}
									}
								}
								NOT = {
									any_neighbor_province = {
										owned_by = root
										OR = {
											has_building = fort_15th
											has_building = fort_16th
											has_building = fort_17th
											has_building = fort_18th
										}
									}
								}
							}
						}
					}
					AND = {
						has_building = fort_15th
						ROOT = { mil_tech = 14 }
					}
					AND = {
						has_building = fort_16th
						ROOT = { mil_tech = 19 }
					}
					AND = {
						has_building = fort_17th
						ROOT = { mil_tech = 24 }
					}
				}
				NOT = { has_building = fort_18th }
			}
			save_event_target_as = agenda_province
		}
		random_owned_province = {
			limit = {
				OR = {
					region = lencenor_region
					region = west_dameshead_region
				}
				OR = {
					AND = {
						NOT = { has_building = fort_15th }
						NOT = { has_building = fort_16th }
						NOT = { has_building = fort_17th }
						NOT = { has_building = fort_18th }
						num_free_building_slots = 1
						any_neighbor_province = {
							owner = {
								OR = {
									is_rival = root
									root = { is_rival = prev }
									AND = {
										is_subject_other_than_tributary_trigger = yes
										overlord = {
											OR = {
												is_rival = root
												root = { is_rival = prev }
											}
										}
									}
								}
							}
						}
						NOT = {
							any_neighbor_province = {
								owned_by = root
								OR = {
									has_building = fort_15th
									has_building = fort_16th
									has_building = fort_17th
									has_building = fort_18th
								}
							}
						}
						has_terrain = hills
					}
					AND = {
						NOT = { has_building = fort_15th }
						NOT = { has_building = fort_16th }
						NOT = { has_building = fort_17th }
						NOT = { has_building = fort_18th }
						num_free_building_slots = 1
						any_neighbor_province = {
							owned_by = root
							any_neighbor_province = {
								owner = {
									OR = {
										is_rival = root
										root = { is_rival = prev }
										AND = {
											is_subject_other_than_tributary_trigger = yes
											overlord = {
												OR = {
													is_rival = root
													root = { is_rival = prev }
												}
											}
										}
									}
								}
								NOT = {
									any_neighbor_province = {
										owned_by = root
										OR = {
											has_building = fort_15th
											has_building = fort_16th
											has_building = fort_17th
											has_building = fort_18th
										}
									}
								}
							}
						}
						has_terrain = hills
					}
					AND = {
						has_building = fort_15th
						ROOT = { mil_tech = 14 }
					}
					AND = {
						has_building = fort_16th
						ROOT = { mil_tech = 19 }
					}
					AND = {
						has_building = fort_17th
						ROOT = { mil_tech = 24 }
					}
				}
				NOT = { has_building = fort_18th }
			}
			save_event_target_as = agenda_province
		}
		random_owned_province = {
			limit = {
				OR = {
					region = lencenor_region
					region = west_dameshead_region
				}
				OR = {
					AND = {
						NOT = { has_building = fort_15th }
						NOT = { has_building = fort_16th }
						NOT = { has_building = fort_17th }
						NOT = { has_building = fort_18th }
						num_free_building_slots = 1
						any_neighbor_province = {
							owner = {
								OR = {
									is_rival = root
									root = { is_rival = prev }
									AND = {
										is_subject_other_than_tributary_trigger = yes
										overlord = {
											OR = {
												is_rival = root
												root = { is_rival = prev }
											}
										}
									}
								}
							}
						}
						NOT = {
							any_neighbor_province = {
								owned_by = root
								OR = {
									has_building = fort_15th
									has_building = fort_16th
									has_building = fort_17th
									has_building = fort_18th
								}
							}
						}
						has_terrain = highlands
					}
					AND = {
						NOT = { has_building = fort_15th }
						NOT = { has_building = fort_16th }
						NOT = { has_building = fort_17th }
						NOT = { has_building = fort_18th }
						num_free_building_slots = 1
						any_neighbor_province = {
							owned_by = root
							any_neighbor_province = {
								owner = {
									OR = {
										is_rival = root
										root = { is_rival = prev }
										AND = {
											is_subject_other_than_tributary_trigger = yes
											overlord = {
												OR = {
													is_rival = root
													root = { is_rival = prev }
												}
											}
										}
									}
								}
								NOT = {
									any_neighbor_province = {
										owned_by = root
										OR = {
											has_building = fort_15th
											has_building = fort_16th
											has_building = fort_17th
											has_building = fort_18th
										}
									}
								}
							}
						}
						has_terrain = highlands
					}
					AND = {
						has_building = fort_15th
						ROOT = { mil_tech = 14 }
					}
					AND = {
						has_building = fort_16th
						ROOT = { mil_tech = 19 }
					}
					AND = {
						has_building = fort_17th
						ROOT = { mil_tech = 24 }
					}
				}
				NOT = { has_building = fort_18th }
			}
			save_event_target_as = agenda_province
		}
		random_owned_province = {
			limit = {
				OR = {
					region = lencenor_region
					region = west_dameshead_region
				}
				OR = {
					AND = {
						NOT = { has_building = fort_15th }
						NOT = { has_building = fort_16th }
						NOT = { has_building = fort_17th }
						NOT = { has_building = fort_18th }
						num_free_building_slots = 1
						any_neighbor_province = {
							owner = {
								OR = {
									is_rival = root
									root = { is_rival = prev }
									AND = {
										is_subject_other_than_tributary_trigger = yes
										overlord = {
											OR = {
												is_rival = root
												root = { is_rival = prev }
											}
										}
									}
								}
							}
						}
						NOT = {
							any_neighbor_province = {
								owned_by = root
								OR = {
									has_building = fort_15th
									has_building = fort_16th
									has_building = fort_17th
									has_building = fort_18th
								}
							}
						}
						has_terrain = mountain
					}
					AND = {
						NOT = { has_building = fort_15th }
						NOT = { has_building = fort_16th }
						NOT = { has_building = fort_17th }
						NOT = { has_building = fort_18th }
						num_free_building_slots = 1
						any_neighbor_province = {
							owned_by = root
							any_neighbor_province = {
								owner = {
									OR = {
										is_rival = root
										root = { is_rival = prev }
										AND = {
											is_subject_other_than_tributary_trigger = yes
											overlord = {
												OR = {
													is_rival = root
													root = { is_rival = prev }
												}
											}
										}
									}
								}
								NOT = {
									any_neighbor_province = {
										owned_by = root
										OR = {
											has_building = fort_15th
											has_building = fort_16th
											has_building = fort_17th
											has_building = fort_18th
										}
									}
								}
							}
						}
						has_terrain = mountain
					}
					AND = {
						has_building = fort_15th
						ROOT = { mil_tech = 14 }
					}
					AND = {
						has_building = fort_16th
						ROOT = { mil_tech = 19 }
					}
					AND = {
						has_building = fort_17th
						ROOT = { mil_tech = 24 }
					}
				}
				NOT = { has_building = fort_18th }
			}
			save_event_target_as = agenda_province
		}
		event_target:agenda_province = {
			if = {
				limit = {
					has_building = fort_17th
				}
				ROOT = {
					set_variable = {
						which = estate_lorentish_elite_build_fort_building_in_y_var
						value = 4
					}
				}
			}
			else_if = {
				limit = {
					has_building = fort_16th
				}
				ROOT = {
					set_variable = {
						which = estate_lorentish_elite_build_fort_building_in_y_var
						value = 3
					}
				}
			}
			else_if = {
				limit = {
					has_building = fort_15th
				}
				ROOT = {
					set_variable = {
						which = estate_lorentish_elite_build_fort_building_in_y_var
						value = 2
					}
				}
			}
			else = {
				ROOT = {
					set_variable = {
						which = estate_lorentish_elite_build_fort_building_in_y_var
						value = 1
					}
				}
			}
		}
	}
	provinces_to_highlight = {
		province_id = event_target:agenda_province
	}
	fail_if = {
		event_target:agenda_province = {
			NOT = { owned_by = root }
		}
	}
	task_requirements = {
		if = {
			limit = {
				has_estate_agenda_auto_completion = {
					estate = estate_lorentish_elite
				}
			}
			has_estate_agenda_auto_completion = {
				estate = estate_lorentish_elite
			}
		}
		else = {
			if = {
				limit = {
					check_variable = {
						which = estate_lorentish_elite_build_fort_building_in_y_var
						value = 4
					}
				}
				event_target:agenda_province = {
					has_building = fort_18th
				}
			}
			else_if = {
				limit = {
					check_variable = {
						which = estate_lorentish_elite_build_fort_building_in_y_var
						value = 3
					}
				}
				event_target:agenda_province = {
					OR = {
						has_building = fort_17th
						has_building = fort_18th
					}
				}
			}
			else_if = {
				limit = {
					check_variable = {
						which = estate_lorentish_elite_build_fort_building_in_y_var
						value = 2
					}
				}
				event_target:agenda_province = {
					OR = {
						has_building = fort_16th
						has_building = fort_17th
						has_building = fort_18th
					}
				}
			}
			else = {
				event_target:agenda_province = {
					OR = {
						has_building = fort_15th
						has_building = fort_16th
						has_building = fort_17th
						has_building = fort_18th
					}
				}
			}
		}
	}
	task_completed_effect = {
		on_completed_agenda_effect = {
			estate = estate_lorentish_elite
		}
		add_estate_loyalty = {
			estate = estate_lorentish_elite
			loyalty = 10
		}
		event_target:agenda_province = {
			add_base_manpower = 1
		}
	}
	failing_effect = {
		on_failed_agenda_effect = yes
		clr_auto_complete_flag = yes
		event_target:agenda_province = {
			if = {
				limit = { owned_by = root }
				add_named_unrest = {
					name = local_nobles_displeased
					value = 5
				}
			}
		}
		add_estate_loyalty_modifier = {
			estate = estate_lorentish_elite
			desc = EST_VAL_AGENDA_DENIED
			loyalty = -5
			duration = 7300
		}
	}
}

estate_lorentish_elite_build_trade_building_in_y = {
	can_select = {
		dip_tech = 4
		any_owned_province = {
			OR = {
				region = lencenor_region
				region = west_dameshead_region
			}
			is_state_core = root
			NOT = { has_building = stock_exchange }
			OR = {
				AND = {
					NOT = { has_building = marketplace }
					NOT = { has_building = trade_depot }
					num_free_building_slots = 1
				}
				AND = {
					ROOT = { dip_tech = 17 }
					NOT = { has_building = trade_depot }
					OR = {
						num_free_building_slots = 1
						has_building = marketplace
					}
				}
				AND = {
					ROOT = { dip_tech = 22 }
					OR = {
						num_free_building_slots = 1
						has_building = trade_depot
					}
				}
			}
		}
	}
	selection_weight = {
		factor = 1
		modifier = {
			factor = 0.65
			NOT = {
				any_owned_province = {
					OR = {
						region = lencenor_region
						region = west_dameshead_region
					}
					is_state_core = root
					OR = {
						province_has_center_of_trade_of_level = 1
						province_trade_power = 10
					}
					NOT = { has_building = stock_exchange }
					OR = {
						AND = {
							NOT = { has_building = marketplace }
							NOT = { has_building = trade_depot }
							num_free_building_slots = 1
						}
						AND = {
							ROOT = { dip_tech = 17 }
							NOT = { has_building = trade_depot }
							OR = {
								num_free_building_slots = 1
								has_building = marketplace
							}
						}
						AND = {
							ROOT = { dip_tech = 22 }
							OR = {
								num_free_building_slots = 1
								has_building = trade_depot
							}
						}
					}
				}
			}
		}
		modifier = {
			factor = 1.2
			any_owned_province = {
				OR = {
					region = lencenor_region
					region = west_dameshead_region
				}
				is_state_core = root
				OR = {
					province_has_center_of_trade_of_level = 2
					province_trade_power = 20
				}
				NOT = { has_building = stock_exchange }
				OR = {
					AND = {
						NOT = { has_building = marketplace }
						NOT = { has_building = trade_depot }
						num_free_building_slots = 1
					}
					AND = {
						ROOT = { dip_tech = 17 }
						NOT = { has_building = trade_depot }
						OR = {
							num_free_building_slots = 1
							has_building = marketplace
						}
					}
					AND = {
						ROOT = { dip_tech = 22 }
						OR = {
							num_free_building_slots = 1
							has_building = trade_depot
						}
					}
				}
			}
		}
		modifier = {
			factor = 2
			is_institution_enabled = global_trade
			NOT = { has_institution = global_trade }
		}
		modifier = {
			factor = 2
			NOT = {
				crown_land_share = 15
			}
		}
	}
	pre_effect = {
		set_variable = {
			which = estate_lorentish_elite_build_trade_building_in_y_var
			value = 0
		}
		random_owned_province = {
			limit = {
				OR = {
					region = lencenor_region
					region = west_dameshead_region
				}
				is_state_core = root
				NOT = { has_building = stock_exchange }
				OR = {
					AND = {
						NOT = { has_building = marketplace }
						NOT = { has_building = trade_depot }
						num_free_building_slots = 1
					}
					AND = {
						ROOT = { dip_tech = 17 }
						NOT = { has_building = trade_depot }
						OR = {
							num_free_building_slots = 1
							has_building = marketplace
						}
					}
					AND = {
						ROOT = { dip_tech = 22 }
						OR = {
							num_free_building_slots = 1
							has_building = trade_depot
						}
					}
				}
			}
			save_event_target_as = agenda_province
		}
		random_owned_province = {
			limit = {
				OR = {
					region = lencenor_region
					region = west_dameshead_region
				}
				is_state_core = root
				OR = {
					province_has_center_of_trade_of_level = 1
					province_trade_power = 10
				}
				NOT = { has_building = stock_exchange }
				OR = {
					AND = {
						NOT = { has_building = marketplace }
						NOT = { has_building = trade_depot }
						num_free_building_slots = 1
					}
					AND = {
						ROOT = { dip_tech = 17 }
						NOT = { has_building = trade_depot }
						OR = {
							num_free_building_slots = 1
							has_building = marketplace
						}
					}
					AND = {
						ROOT = { dip_tech = 22 }
						OR = {
							num_free_building_slots = 1
							has_building = trade_depot
						}
					}
				}
			}
			save_event_target_as = agenda_province
		}
		random_owned_province = {
			limit = {
				OR = {
					region = lencenor_region
					region = west_dameshead_region
				}
				is_state_core = root
				OR = {
					province_has_center_of_trade_of_level = 2
					province_trade_power = 20
				}
				NOT = { has_building = stock_exchange }
				OR = {
					AND = {
						NOT = { has_building = marketplace }
						NOT = { has_building = trade_depot }
						num_free_building_slots = 1
					}
					AND = {
						ROOT = { dip_tech = 17 }
						NOT = { has_building = trade_depot }
						OR = {
							num_free_building_slots = 1
							has_building = marketplace
						}
					}
					AND = {
						ROOT = { dip_tech = 22 }
						OR = {
							num_free_building_slots = 1
							has_building = trade_depot
						}
					}
				}
			}
			save_event_target_as = agenda_province
		}
		event_target:agenda_province = {
			if = {
				limit = {
					has_building = trade_depot
				}
				ROOT = {
					set_variable = {
						which = estate_lorentish_elite_build_trade_building_in_y_var
						value = 3
					}
				}
			}
			else_if = {
				limit = {
					has_building = marketplace
				}
				ROOT = {
					set_variable = {
						which = estate_lorentish_elite_build_trade_building_in_y_var
						value = 2
					}
				}
			}
			else = {
				ROOT = {
					set_variable = {
						which = estate_lorentish_elite_build_trade_building_in_y_var
						value = 1
					}
				}
			}
		}
	}
	provinces_to_highlight = {
		province_id = event_target:agenda_province
	}
	fail_if = {
		event_target:agenda_province = {
			NOT = { owned_by = root }
		}
	}
	task_requirements = {
		if = {
			limit = {
				has_estate_agenda_auto_completion = {
					estate = estate_lorentish_elite
				}
			}
			has_estate_agenda_auto_completion = {
				estate = estate_lorentish_elite
			}
		}
		else = {
			if = {
				limit = {
					check_variable = {
						which = estate_lorentish_elite_build_trade_building_in_y_var
						value = 3
					}
				}
				event_target:agenda_province = {
					has_building = stock_exchange
				}
			}
			else_if = {
				limit = {
					check_variable = {
						which = estate_lorentish_elite_build_trade_building_in_y_var
						value = 2
					}
				}
				event_target:agenda_province = {
					OR = {
						has_building = trade_depot
						has_building = stock_exchange
					}
				}
			}
			else = {
				event_target:agenda_province = {
					OR = {
						has_building = marketplace
						has_building = trade_depot
						has_building = stock_exchange
					}
				}
			}
		}
	}
	task_completed_effect = {
		on_completed_agenda_effect = {
			estate = estate_lorentish_elite
		}
		add_estate_loyalty = {
			estate = estate_lorentish_elite
			loyalty = 10
		}
		if = {
			limit = {
				NOT = { crown_land_share = 15 }
				estate_territory = {
					estate = estate_lorentish_elite
					territory = 10
				}
				estate_not_has_exempt_from_seize_land_privilege = { estate = estate_lorentish_elite }
			}
			take_estate_land_share_small = { estate = estate_lorentish_elite }
		}
		else = {
			event_target:agenda_province = {
				add_base_production = 1
			}
		}
	}
	failing_effect = {
		on_failed_agenda_effect = yes
		clr_auto_complete_flag = yes
		event_target:agenda_province = {
			if = {
				limit = { owned_by = root }
				add_named_unrest = {
					name = local_burghers_displeased
					value = 5
				}
			}
		}
		add_estate_loyalty_modifier = {
			estate = estate_lorentish_elite
			desc = EST_VAL_AGENDA_DENIED
			loyalty = -5
			duration = 7300
		}
	}
}

estate_lorentish_elite_build_port_building_in_y = {
	can_select = {
		dip_tech = 6
		any_owned_province = {
			OR = {
				region = lencenor_region
				region = west_dameshead_region
			}
			is_state_core = root
			has_port = yes
			OR = {
				NOT = { has_building = grand_shipyard }
				NOT = { has_building = drydock }
			}
			OR = {
				AND = {
					NOT = { has_building = dock }
					num_free_building_slots = 1
				}
				AND = {
					ROOT = { dip_tech = 8 }
					NOT = { has_building = shipyard }
					num_free_building_slots = 1
				}
				AND = {
					ROOT = { dip_tech = 19 }
					NOT = { has_building = drydock }
					OR = {
						num_free_building_slots = 1
						has_building = dock
					}
				}
				AND = {
					ROOT = { dip_tech = 24 }
					NOT = { has_building = grand_shipyard }
					OR = {
						num_free_building_slots = 1
						has_building = shipyard
					}
				}
			}
		}
	}
	selection_weight = {
		factor = 1
		modifier = {
			factor = 0.75
			always = yes
		}
		modifier = {
			factor = 2
			NOT = {
				crown_land_share = 15
			}
		}
	}
	pre_effect = {
		set_variable = {
			which = estate_lorentish_elite_build_port_building_in_y_var
			value = 0
		}
		random_owned_province = {
			limit = {
				OR = {
					region = lencenor_region
					region = west_dameshead_region
				}
				is_state_core = root
				has_port = yes
				OR = {
					NOT = { has_building = grand_shipyard }
					NOT = { has_building = drydock }
				}
				OR = {
					AND = {
						NOT = { has_building = dock }
						num_free_building_slots = 1
					}
					AND = {
						ROOT = { dip_tech = 8 }
						NOT = { has_building = shipyard }
						num_free_building_slots = 1
					}
					AND = {
						ROOT = { dip_tech = 19 }
						NOT = { has_building = drydock }
						OR = {
							num_free_building_slots = 1
							has_building = dock
						}
					}
					AND = {
						ROOT = { dip_tech = 24 }
						NOT = { has_building = grand_shipyard }
						OR = {
							num_free_building_slots = 1
							has_building = shipyard
						}
					}
				}
			}
			save_event_target_as = agenda_province
		}
		random_owned_province = {
			limit = {
				OR = {
					region = lencenor_region
					region = west_dameshead_region
				}
				is_state_core = root
				development = 12
				has_port = yes
				OR = {
					NOT = { has_building = grand_shipyard }
					NOT = { has_building = drydock }
				}
				OR = {
					AND = {
						NOT = { has_building = dock }
						num_free_building_slots = 1
					}
					AND = {
						ROOT = { dip_tech = 8 }
						NOT = { has_building = shipyard }
						num_free_building_slots = 1
					}
					AND = {
						ROOT = { dip_tech = 19 }
						NOT = { has_building = drydock }
						OR = {
							num_free_building_slots = 1
							has_building = dock
						}
					}
					AND = {
						ROOT = { dip_tech = 24 }
						NOT = { has_building = grand_shipyard }
						OR = {
							num_free_building_slots = 1
							has_building = shipyard
						}
					}
				}
			}
			save_event_target_as = agenda_province
		}
		random_owned_province = {
			limit = {
				OR = {
					region = lencenor_region
					region = west_dameshead_region
				}
				is_state_core = root
				development = 20
				has_port = yes
				OR = {
					NOT = { has_building = grand_shipyard }
					NOT = { has_building = drydock }
				}
				OR = {
					AND = {
						NOT = { has_building = dock }
						num_free_building_slots = 1
					}
					AND = {
						ROOT = { dip_tech = 8 }
						NOT = { has_building = shipyard }
						num_free_building_slots = 1
					}
					AND = {
						ROOT = { dip_tech = 19 }
						NOT = { has_building = drydock }
						OR = {
							num_free_building_slots = 1
							has_building = dock
						}
					}
					AND = {
						ROOT = { dip_tech = 24 }
						NOT = { has_building = grand_shipyard }
						OR = {
							num_free_building_slots = 1
							has_building = shipyard
						}
					}
				}
			}
			save_event_target_as = agenda_province
		}
		event_target:agenda_province = {
			if = {
				limit = {
					has_building = shipyard
					NOT = { has_building = grand_shipyard }
					ROOT = { dip_tech = 24 }
				}
				ROOT = {
					set_variable = {
						which = estate_lorentish_elite_build_port_building_in_y_var
						value = 4
					}
				}
			}
			else_if = {
				limit = {
					NOT = { has_building = shipyard }
					NOT = { has_building = grand_shipyard }
					ROOT = { dip_tech = 8 }
				}
				ROOT = {
					set_variable = {
						which = estate_lorentish_elite_build_port_building_in_y_var
						value = 3
					}
				}
			}
			else_if = {
				limit = {
					has_building = dock
				}
				ROOT = {
					set_variable = {
						which = estate_lorentish_elite_build_port_building_in_y_var
						value = 2
					}
				}
			}
			else = {
				ROOT = {
					set_variable = {
						which = estate_lorentish_elite_build_port_building_in_y_var
						value = 1
					}
				}
			}
		}
	}
	provinces_to_highlight = {
		province_id = event_target:agenda_province
	}
	fail_if = {
		event_target:agenda_province = {
			NOT = { owned_by = root }
		}
	}
	task_requirements = {
		if = {
			limit = {
				has_estate_agenda_auto_completion = {
					estate = estate_lorentish_elite
				}
			}
			has_estate_agenda_auto_completion = {
				estate = estate_lorentish_elite
			}
		}
		else = {
			if = {
				limit = {
					check_variable = {
						which = estate_lorentish_elite_build_port_building_in_y_var
						value = 4
					}
				}
				event_target:agenda_province = {
					has_building = grand_shipyard
				}
			}
			else_if = {
				limit = {
					check_variable = {
						which = estate_lorentish_elite_build_port_building_in_y_var
						value = 3
					}
				}
				event_target:agenda_province = {
					OR = {
						has_building = shipyard
						has_building = grand_shipyard
					}
				}
			}
			else_if = {
				limit = {
					check_variable = {
						which = estate_lorentish_elite_build_port_building_in_y_var
						value = 2
					}
				}
				event_target:agenda_province = {
					has_building = drydock
				}
			}
			else = {
				event_target:agenda_province = {
					OR = {
						has_building = dock
						has_building = drydock
					}
				}
			}
		}
	}
	task_completed_effect = {
		on_completed_agenda_effect = {
			estate = estate_lorentish_elite
		}
		add_estate_loyalty = {
			estate = estate_lorentish_elite
			loyalty = 10
		}
		if = {
			limit = {
				NOT = { crown_land_share = 15 }
				estate_territory = {
					estate = estate_lorentish_elite
					territory = 10
				}
				estate_not_has_exempt_from_seize_land_privilege = { estate = estate_lorentish_elite }
			}
			take_estate_land_share_small = { estate = estate_lorentish_elite }
		}
		else = {
			event_target:agenda_province = {
				add_base_production = 1
			}
		}
	}
	failing_effect = {
		on_failed_agenda_effect = yes
		clr_auto_complete_flag = yes
		event_target:agenda_province = {
			if = {
				limit = { owned_by = root }
				add_named_unrest = {
					name = local_burghers_displeased
					value = 5
				}
			}
		}
		add_estate_loyalty_modifier = {
			estate = estate_lorentish_elite
			desc = EST_VAL_AGENDA_DENIED
			loyalty = -5
			duration = 7300
		}
	}
}

estate_lorentish_elite_build_production_building_in_y = {
	can_select = {
		adm_tech = 6
		any_owned_province = {
			OR = {
				region = lencenor_region
				region = west_dameshead_region
			}
			is_state_core = root
			NOT = { has_building = counting_house }
			OR = {
				AND = {
					NOT = { has_building = workshop }
					num_free_building_slots = 1
				}
				AND = {
					ROOT = { adm_tech = 24 }
					OR = {
						has_building = workshop
						num_free_building_slots = 1
					}
				}
			}
			NOT = { trade_goods = gold }
		}
	}
	selection_weight = {
		factor = 1
		modifier = {
			factor = 0.65
			NOT = {
				any_owned_province = {
					OR = {
						region = lencenor_region
						region = west_dameshead_region
					}
					is_state_core = root
					base_production = 4
					NOT = { has_building = counting_house }
					OR = {
						AND = {
							NOT = { has_building = workshop }
							num_free_building_slots = 1
						}
						AND = {
							ROOT = { adm_tech = 24 }
							OR = {
								has_building = workshop
								num_free_building_slots = 1
							}
						}
					}
					NOT = { trade_goods = gold }
				}
			}
		}
		modifier = {
			factor = 1.2
			any_owned_province = {
				OR = {
					region = lencenor_region
					region = west_dameshead_region
				}
				is_state_core = root
				OR = {
					base_production = 7
					has_building = wharf
					has_building = weapons
					has_building = textile
					has_building = tradecompany
					has_building = farm_estate
					has_building = mills
					has_building = plantations
					has_building = furnace
				}
				NOT = { has_building = counting_house }
				OR = {
					AND = {
						NOT = { has_building = workshop }
						num_free_building_slots = 1
					}
					AND = {
						ROOT = { adm_tech = 24 }
						OR = {
							has_building = workshop
							num_free_building_slots = 1
						}
					}
				}
				NOT = { trade_goods = gold }
			}
		}
		modifier = {
			factor = 2
			NOT = {
				crown_land_share = 15
			}
		}
	}
	pre_effect = {
		set_variable = {
			which = estate_lorentish_elite_build_production_building_in_y_var
			value = 0
		}
		random_owned_province = {
			limit = {
				OR = {
					region = lencenor_region
					region = west_dameshead_region
				}
				is_state_core = root
				NOT = { has_building = counting_house }
				OR = {
					AND = {
						NOT = { has_building = workshop }
						num_free_building_slots = 1
					}
					AND = {
						ROOT = { adm_tech = 24 }
						OR = {
							has_building = workshop
							num_free_building_slots = 1
						}
					}
				}
				NOT = { trade_goods = gold }
			}
			save_event_target_as = agenda_province
		}
		random_owned_province = {
			limit = {
				OR = {
					region = lencenor_region
					region = west_dameshead_region
				}
				is_state_core = root
				base_production = 4
				NOT = { has_building = counting_house }
				OR = {
					AND = {
						NOT = { has_building = workshop }
						num_free_building_slots = 1
					}
					AND = {
						ROOT = { adm_tech = 24 }
						OR = {
							has_building = workshop
							num_free_building_slots = 1
						}
					}
				}
				NOT = { trade_goods = gold }
			}
			save_event_target_as = agenda_province
		}
		random_owned_province = {
			limit = {
				OR = {
					region = lencenor_region
					region = west_dameshead_region
				}
				is_state_core = root
				OR = {
					base_production = 7
					has_building = wharf
					has_building = weapons
					has_building = textile
					has_building = tradecompany
					has_building = farm_estate
					has_building = mills
					has_building = plantations
					has_building = furnace
				}
				NOT = { has_building = counting_house }
				OR = {
					AND = {
						NOT = { has_building = workshop }
						num_free_building_slots = 1
					}
					AND = {
						ROOT = { adm_tech = 24 }
						OR = {
							has_building = workshop
							num_free_building_slots = 1
						}
					}
				}
				NOT = { trade_goods = gold }
			}
			save_event_target_as = agenda_province
		}
		event_target:agenda_province = {
			if = {
				limit = {
					has_building = workshop
				}
				ROOT = {
					set_variable = {
						which = estate_lorentish_elite_build_production_building_in_y_var
						value = 2
					}
				}
			}
			else = {
				ROOT = {
					set_variable = {
						which = estate_lorentish_elite_build_production_building_in_y_var
						value = 1
					}
				}
			}
		}
	}
	provinces_to_highlight = {
		province_id = event_target:agenda_province
	}
	fail_if = {
		event_target:agenda_province = {
			NOT = { owned_by = root }
		}
	}
	task_requirements = {
		if = {
			limit = {
				has_estate_agenda_auto_completion = {
					estate = estate_lorentish_elite
				}
			}
			has_estate_agenda_auto_completion = {
				estate = estate_lorentish_elite
			}
		}
		else = {
			if = {
				limit = {
					check_variable = {
						which = estate_lorentish_elite_build_production_building_in_y_var
						value = 2
					}
				}
				event_target:agenda_province = {
					has_building = counting_house
				}
			}
			else = {
				event_target:agenda_province = {
					OR = {
						has_building = workshop
						has_building = counting_house
					}
				}
			}
		}
	}
	task_completed_effect = {
		on_completed_agenda_effect = {
			estate = estate_lorentish_elite
		}
		add_estate_loyalty = {
			estate = estate_lorentish_elite
			loyalty = 10
		}
		if = {
			limit = {
				NOT = { crown_land_share = 15 }
				estate_territory = {
					estate = estate_lorentish_elite
					territory = 10
				}
				estate_not_has_exempt_from_seize_land_privilege = { estate = estate_lorentish_elite }
			}
			take_estate_land_share_small = { estate = estate_lorentish_elite }
		}
		else = {
			event_target:agenda_province = {
				add_base_production = 1
			}
		}
	}
	failing_effect = {
		on_failed_agenda_effect = yes
		clr_auto_complete_flag = yes
		event_target:agenda_province = {
			if = {
				limit = { owned_by = root }
				add_named_unrest = {
					name = local_burghers_displeased
					value = 5
				}
			}
		}
		add_estate_loyalty_modifier = {
			estate = estate_lorentish_elite
			desc = EST_VAL_AGENDA_DENIED
			loyalty = -5
			duration = 7300
		}
	}
}

estate_lorentish_elite_build_manufactory_in_y = {
	can_select = {
		any_owned_province = {
			OR = {
				region = lencenor_region
				region = west_dameshead_region
			}
			is_state_core = root
			root_can_build_manufactory_here_trigger = yes
		}
		monthly_income = 30
	}
	selection_weight = {
		factor = 1
		modifier = {
			factor = 0.5
			OR = {
				current_age = age_of_discovery
				current_age = age_of_reformation
			}
		}
		modifier = {
			factor = 0.5
			NOT = { monthly_income = 40 }
		}
		modifier = {
			factor = 2
			monthly_income = 60
		}
		modifier = {
			factor = 2
			is_institution_enabled = manufactories
			NOT = { has_institution = manufactories }
		}
	}
	pre_effect = {
		random_owned_province = {
			limit = {
				OR = {
					region = lencenor_region
					region = west_dameshead_region
				}
				is_state_core = root
				root_can_build_manufactory_here_trigger = yes
				has_nobles_trade_good_trigger = yes
			}
			save_event_target_as = agenda_province
		}
		random_owned_province = {
			limit = {
				OR = {
					region = lencenor_region
					region = west_dameshead_region
				}
				is_state_core = root
				base_production = 5
				root_can_build_manufactory_here_trigger = yes
				has_nobles_trade_good_trigger = yes
			}
			save_event_target_as = agenda_province
		}
		random_owned_province = {
			limit = {
				OR = {
					region = lencenor_region
					region = west_dameshead_region
				}
				is_state_core = root
				base_production = 10
				root_can_build_manufactory_here_trigger = yes
				has_nobles_trade_good_trigger = yes
			}
			save_event_target_as = agenda_province
		}
	}
	provinces_to_highlight = {
		province_id = event_target:agenda_province
	}
	fail_if = {
		event_target:agenda_province = {
			NOT = { owned_by = root }
		}
	}
	task_requirements = {
		if = {
			limit = {
				has_estate_agenda_auto_completion = {
					estate = estate_lorentish_elite
				}
			}
			has_estate_agenda_auto_completion = {
				estate = estate_lorentish_elite
			}
		}
		else = {
			event_target:agenda_province = {
				custom_trigger_tooltip = {
					tooltip = has_manufactory_trigger_tooltip
					OR = {
						if = {
							limit = {
								OR = {
									trade_goods = naval_supplies
									trade_goods = fish
									trade_goods = salt
								}
							}
							has_building = wharf
						}
						else_if = {
							limit = {
								OR = {
									trade_goods = copper
									trade_goods = iron
								}
							}
							has_building = weapons
						}
						else_if = {
							limit = {
								OR = {
									trade_goods = wool
									trade_goods = cloth
									trade_goods = silk
									trade_goods = dyes
								}
							}
							has_building = textile
						}
						else_if = {
							limit = {
								OR = {
									trade_goods = ivory
									trade_goods = slaves
									trade_goods = spices
									trade_goods = cloves
									trade_goods = fur
									trade_goods = incense
								}
							}
							has_building = tradecompany
						}
						else_if = {
							limit = {
								OR = {
									trade_goods = grain
									trade_goods = livestock
									trade_goods = wine
								}
							}
							has_building = farm_estate
						}
						else_if = {
							limit = {
								OR = {
									trade_goods = paper
									trade_goods = gems
									trade_goods = tropical_wood
									trade_goods = glass
									trade_goods = chinaware
								}
							}
							has_building = mills
						}
						else_if = {
							limit = {
								trade_goods = coal
							}
							has_building = furnace
						}
						else = {
							has_building = plantations
						}
						has_building = ramparts
						has_building = soldier_households
						has_building = impressment_offices
						has_building = state_house
					}
				}
			}
		}
	}
	task_completed_effect = {
		on_completed_agenda_effect = {
			estate = estate_lorentish_elite
		}
		add_estate_loyalty = {
			estate = estate_lorentish_elite
			loyalty = 10
		}
		event_target:agenda_province = {
			add_base_production = 1
			add_province_modifier = {
				name = prospering_production
				duration = 5475
			}
		}
	}
	failing_effect = {
		on_failed_agenda_effect = yes
		clr_auto_complete_flag = yes
		event_target:agenda_province = {
			if = {
				limit = { owned_by = root }
				add_named_unrest = {
					name = local_nobles_displeased
					value = 5
				}
			}
		}
		add_estate_loyalty_modifier = {
			estate = estate_lorentish_elite
			desc = EST_VAL_AGENDA_DENIED
			loyalty = -5
			duration = 7300
		}
	}
}

estate_lorentish_elite_build_university_in_y = {
	can_select = {
		government = monarchy
		adm_tech = 17
		any_owned_province = {
			OR = {
				region = lencenor_region
				region = west_dameshead_region
			}
			is_state_core = root
			NOT = { has_building = university }
			OR = {
				development = 10
				is_capital = yes
			}
		}
	}
	selection_weight = {
		factor = 1
		modifier = {
			factor = 0.75
			NOT = {
				any_owned_province = {
					OR = {
						region = lencenor_region
						region = west_dameshead_region
					}
					is_state_core = root
					NOT = { has_building = university }
					development = 15
				}
			}
		}
		modifier = {
			factor = 1.2
			any_owned_province = {
				OR = {
					region = lencenor_region
					region = west_dameshead_region
				}
				is_state_core = root
				NOT = { has_building = university }
				development = 20
			}
		}
		modifier = {
			factor = 2
			is_institution_enabled = enlightenment
			NOT = { has_institution = enlightenment }
		}
	}
	pre_effect = {
		random_owned_province = {
			limit = {
				OR = {
					region = lencenor_region
					region = west_dameshead_region
				}
				is_state_core = root
				NOT = { has_building = university }
				development = 10
			}
			save_event_target_as = agenda_province
		}
		random_owned_province = {
			limit = {
				OR = {
					region = lencenor_region
					region = west_dameshead_region
				}
				is_state_core = root
				NOT = { has_building = university }
				development = 15
			}
			save_event_target_as = agenda_province
		}
		random_owned_province = {
			limit = {
				OR = {
					region = lencenor_region
					region = west_dameshead_region
				}
				is_state_core = root
				NOT = { has_building = university }
				development = 20
			}
			save_event_target_as = agenda_province
		}
		random_owned_province = {
			limit = {
				OR = {
					region = lencenor_region
					region = west_dameshead_region
				}
				is_state_core = root
				NOT = { has_building = university }
				is_capital = yes
			}
			save_event_target_as = agenda_province
		}
	}
	provinces_to_highlight = {
		province_id = event_target:agenda_province
	}
	fail_if = {
		event_target:agenda_province = {
			NOT = { owned_by = root }
		}
	}
	task_requirements = {
		if = {
			limit = {
				has_estate_agenda_auto_completion = {
					estate = estate_lorentish_elite
				}
			}
			has_estate_agenda_auto_completion = {
				estate = estate_lorentish_elite
			}
		}
		else = {
			event_target:agenda_province = {
				has_building = university
			}
		}
	}
	task_completed_effect = {
		on_completed_agenda_effect = {
			estate = estate_lorentish_elite
		}
		add_estate_loyalty = {
			estate = estate_lorentish_elite
			loyalty = 10
		}
		add_adm_power = 35
		add_dip_power = 35
		add_mil_power = 35
	}
	failing_effect = {
		on_failed_agenda_effect = yes
		clr_auto_complete_flag = yes
		event_target:agenda_province = {
			if = {
				limit = { owned_by = root }
				add_named_unrest = {
					name = local_nobles_displeased
					value = 5
				}
			}
		}
		add_estate_loyalty_modifier = {
			estate = estate_lorentish_elite
			desc = EST_VAL_AGENDA_DENIED
			loyalty = -5
			duration = 7300
		}
	}
}

estate_lorentish_elite_convert_province_x = {
	can_select = {
		num_of_missionaries = 1
		NOT = { religion = the_thought }
		any_owned_province = {
			OR = {
				region = lencenor_region
				region = west_dameshead_region
			}
			is_state_core = root
			NOT = { religion = root }
			NOT = { has_province_modifier = religious_zeal_at_conv }
			NOT = { has_province_modifier = expelled_minority }
			NOT = { has_province_modifier = religious_migration }
			NOT = { has_province_modifier = ahati_aakheta_base }
			NOT = { religion = secondary }
			has_missionary = no
			missionary_strength = 0.01
		}
	}
	selection_weight = {
		factor = 1
		modifier = {
			factor = 1.5
			NOT = { religious_unity = 0.85 }
		}
		modifier = {
			factor = 1.5
			NOT = { religious_unity = 0.75 }
		}
		modifier = {
			factor = 1.5
			NOT = { religious_unity = 0.65 }
		}
		modifier = {
			factor = 1.5
			NOT = { religious_unity = 0.5 }
		}
		modifier = {
			factor = 1.5
			NOT = { religious_unity = 0.4 }
		}
		modifier = {
			factor = 0.25
			religion = the_thought
		}
		modifier = {
			factor = 0.35
			has_idea_group = humanist_ideas
		}
		modifier = {
			factor = 2
			has_idea_group = religious_ideas
		}
		modifier = {
			factor = 0.75
			NOT = { num_of_missionaries = 2 }
		}
		modifier = {
			factor = 1.25
			is_defender_of_faith = yes
		}
		modifier = {
			factor = 0.35
			has_country_modifier = recent_converted_province_mission_timer
		}
	}
	pre_effect = {
		random_owned_province = {
			limit = {
				OR = {
					region = lencenor_region
					region = west_dameshead_region
				}
				is_state_core = root
				NOT = { religion = root }
				NOT = { has_province_modifier = religious_zeal_at_conv }
				NOT = { has_province_modifier = expelled_minority }
				NOT = { has_province_modifier = religious_migration }
				NOT = { has_province_modifier = ahati_aakheta_base }
				NOT = { religion = secondary }
				has_missionary = no
			}
			save_event_target_as = agenda_province
		}
		random_owned_province = {
			limit = {
				OR = {
					region = lencenor_region
					region = west_dameshead_region
				}
				is_state_core = root
				NOT = { religion = root }
				NOT = { has_province_modifier = religious_zeal_at_conv }
				NOT = { has_province_modifier = expelled_minority }
				NOT = { has_province_modifier = religious_migration }
				NOT = { has_province_modifier = ahati_aakheta_base }
				NOT = { religion = secondary }
				has_missionary = no
				development = 10
			}
			save_event_target_as = agenda_province
		}
	}
	fail_if = {
		event_target:agenda_province = {
			OR = {
				NOT = { owned_by = root }
				AND = {
					NOT = { religion = root }
					religion = secondary
				}
			}
		}
	}
	immediate_effect = {
		event_target:agenda_province = {
			add_province_modifier = {
				name = agenda_conversion_zeal
				duration = 7300
			}
		}
	}
	on_invalid = {
		event_target:agenda_province = {
			if = {
				limit = { has_province_modifier = agenda_conversion_zeal }
				remove_province_modifier = agenda_conversion_zeal
			}
		}
	}
	provinces_to_highlight = {
		province_id = event_target:agenda_province
	}
	task_requirements = {
		if = {
			limit = {
				has_estate_agenda_auto_completion = {
					estate = estate_lorentish_elite
				}
			}
			has_estate_agenda_auto_completion = {
				estate = estate_lorentish_elite
			}
		}
		else = {
			event_target:agenda_province = {
				religion = root
			}
		}
	}
	task_completed_effect = {
		on_completed_agenda_effect = {
			estate = estate_lorentish_elite
		}
		hidden_effect = {
			event_target:agenda_province = {
				if = {
					limit = { has_province_modifier = agenda_conversion_zeal }
					remove_province_modifier = agenda_conversion_zeal
				}
			}
			add_country_modifier = {
				name = recent_converted_province_mission_timer
				duration = 3650
				hidden = yes
			}
		}
		generate_scaled_advisor_of_type_and_religion_effect = {
			type = inquisitor
			religion = root
			discount = yes
		}
		add_estate_loyalty = {
			estate = estate_lorentish_elite
			loyalty = 10
		}
	}
	failing_effect = {
		on_failed_agenda_effect = yes
		clr_auto_complete_flag = yes
		event_target:agenda_province = {
			if = {
				limit = { has_province_modifier = agenda_conversion_zeal }
				remove_province_modifier = agenda_conversion_zeal
			}
		}
		add_estate_loyalty_modifier = {
			estate = estate_lorentish_elite
			desc = EST_VAL_AGENDA_DENIED
			loyalty = -5
			duration = 7300
		}
	}
}

estate_lorentish_elite_root_out_heresy = {
	can_select = {
		religion = regent_court
		cb_on_religious_enemies = yes
		is_free_or_tributary_trigger = yes
		num_of_cities = 10
		OR = {
			#religion_group = muslim
			#religion_group = christian
			full_idea_group = religious_ideas
		}
		any_neighbor_country = {
			NOT = { tag = Z97 }	#replaces PAP
			religion_group = root
			NOT = { religion = root }
			NOT = { num_of_cities = 6 }
			is_free_or_tributary_trigger = yes
			NOT = { alliance_with = root }
			NOT = { marriage_with = root }
			NOT = { war_with = root }
			NOT = { ROOT = { truce_with = prev } }
			ROOT = {
				NOT = {
					has_opinion = {
						who = prev
						value = 100
					}
				}
			}
			NOT = { army_size = root }
			OR = {
				NOT = { has_dlc = "Art of War" }
				hre_religion_treaty = no
				is_part_of_hre = no
				ROOT = { is_part_of_hre = no }
			}
			OR = {
				is_part_of_hre = no
				NOT = { hre_reform_passed = landfriede }
				ROOT = { is_part_of_hre = no }
			}
		}
	}
	selection_weight = {
		factor = 2
		modifier = {
			factor = 2
			has_idea_group = religious_ideas
		}
		modifier = {
			factor = 0.35
			has_idea_group = humanist_ideas
		}
		modifier = {
			factor = 0.25
			any_country = {
				coalition_target = root
			}
		}
	}
	pre_effect = {
		random_neighbor_country = {
			limit = {
				NOT = { tag = PAP }
				religion_group = root
				NOT = { religion = root }
				NOT = { num_of_cities = 6 }
				is_free_or_tributary_trigger = yes
				NOT = { alliance_with = root }
				NOT = { marriage_with = root }
				NOT = { war_with = root }
				NOT = { ROOT = { truce_with = prev } }
				ROOT = {
					NOT = {
						has_opinion = {
							who = prev
							value = 100
						}
					}
				}
				NOT = { army_size = root }
				OR = {
					NOT = { has_dlc = "Art of War" }
					hre_religion_treaty = no
					is_part_of_hre = no
					ROOT = { is_part_of_hre = no }
				}
				OR = {
					is_part_of_hre = no
					NOT = { hre_reform_passed = landfriede }
					ROOT = { is_part_of_hre = no }
				}
			}
			save_event_target_as = agenda_country
			capital_scope = {
				save_event_target_as = agenda_country_capital
			}
		}
	}
	fail_if = {
		OR = {
			is_subject_other_than_tributary_trigger = yes
			has_country_modifier = recently_changed_religion_dummy
			event_target:agenda_country = {
				is_subject_other_than_tributary_trigger = yes
				NOT = { is_subject_of = root }
			}
			AND = {
				NOT = {
					event_target:agenda_country = {
						num_of_cities = 1
					}
				}
				NOT = {
					event_target:agenda_country_capital = {
						owned_by = root #you annexed them
					}
				}
			}
		}
	}
	provinces_to_highlight = {
		province_id = event_target:agenda_country_capital
	}
	task_requirements = {
		if = {
			limit = {
				has_estate_agenda_auto_completion = {
					estate = estate_lorentish_elite
				}
			}
			has_estate_agenda_auto_completion = {
				estate = estate_lorentish_elite
			}
		}
		else = {
			hidden_trigger = { NOT = { has_country_modifier = recently_changed_religion_dummy } }
			if = {
				limit = {
					event_target:agenda_country = {
						num_of_cities = 1
					}
				}
				event_target:agenda_country = {
					religion = root
				}
			}
			else = {
				event_target:agenda_country_capital = {
					owned_by = root #you annexed them
				}
			}
		}
	}
	task_completed_effect = {
		on_completed_agenda_effect = {
			estate = estate_lorentish_elite
		}
		add_estate_loyalty = {
			estate = estate_lorentish_elite
			loyalty = 10
		}
		generate_scaled_advisor_of_type_and_religion_effect = {
			type = inquisitor
			religion = root
			discount = yes
		}
	}
	failing_effect = {
		on_failed_agenda_effect = yes
		clr_auto_complete_flag = yes
		add_estate_loyalty_modifier = {
			estate = estate_lorentish_elite
			desc = EST_VAL_AGENDA_DENIED
			loyalty = -5
			duration = 7300
		}
	}
}

estate_lorentish_elite_crush_religious_revolts = {
	can_select = {
		religion = regent_court
		num_of_rebel_armies = 1
		OR = {
			has_spawned_rebels = heretic_rebels
			has_spawned_rebels = lollard_rebels
		}

	}
	selection_weight = {
		factor = 2
		modifier = {
			factor = 2
			num_of_rebel_controlled_provinces = 3
		}
		modifier = {
			factor = 2
			num_of_rebel_controlled_provinces = 5
		}
	}
	provinces_to_highlight = {
		owned_by = root
		controlled_by = REB
	}
	fail_if = {
		has_country_modifier = just_lost_to_rebels
	}
	task_requirements = {
		if = {
			limit = {
				has_estate_agenda_auto_completion = {
					estate = estate_lorentish_elite
				}
			}
			has_estate_agenda_auto_completion = {
				estate = estate_lorentish_elite
			}
		}
		else = {
			NOT = { num_of_rebel_controlled_provinces = 1 }
			NOT = { num_of_rebel_armies = 1 }
			hidden_trigger = { NOT = { has_country_modifier = just_lost_to_rebels } }
		}
	}
	task_completed_effect = {
		on_completed_agenda_effect = {
			estate = estate_lorentish_elite
		}
		add_estate_loyalty = {
			estate = estate_lorentish_elite
			loyalty = 15
		}
	}
	failing_effect = {
		on_failed_agenda_effect = yes
		clr_auto_complete_flag = yes
		add_estate_loyalty_modifier = {
			estate = estate_lorentish_elite
			desc = EST_VAL_AGENDA_DENIED
			loyalty = -5
			duration = 7300
		}
	}
}

estate_lorentish_elite_protect_brethren = {
	can_select = {
		religion = regent_court
		is_free_or_tributary_trigger = yes
		is_at_war = no
		any_neighbor_country = {
			NOT = { religion = root }
		}
		any_owned_province = {
			any_neighbor_province = {
				NOT = { owned_by = root }
				is_city = yes
				religion = root
				has_discovered = root
				owner = {
					is_free_or_tributary_trigger = yes
					NOT = { religion = root }
					NOT = { religion = the_thought }
					NOT = { is_subject_of = root }
					NOT = { overlord_of = root }
					NOT = { alliance_with = root }
					NOT = { ROOT = { truce_with = prev } }
					OR = {
						is_part_of_hre = no
						NOT = { hre_reform_passed = landfriede }
						ROOT = { is_part_of_hre = no }
					}
				}
				NOT = { religion = secondary }
			}
		}
	}
	selection_weight = {
		factor = 2
		modifier = {
			factor = 2
			has_idea_group = religious_ideas
		}
		modifier = {
			factor = 0.25
			any_country = {
				coalition_target = root
			}
		}
	}
	pre_effect = {
		random_owned_province = {
			limit = {
				any_neighbor_province = {
					NOT = { owned_by = root }
					is_city = yes
					religion = root
					has_discovered = root
					owner = {
						is_free_or_tributary_trigger = yes
						NOT = { religion = root }
						NOT = { religion = the_thought }
						NOT = { is_subject_of = root }
						NOT = { overlord_of = root }
						NOT = { alliance_with = root }
						NOT = { ROOT = { truce_with = prev } }
						OR = {
							is_part_of_hre = no
							NOT = { hre_reform_passed = landfriede }
							ROOT = { is_part_of_hre = no }
						}
					}
					NOT = { religion = secondary }
				}
			}
			random_neighbor_province = {
				limit = {
					NOT = { owned_by = root }
					is_city = yes
					religion = root
					has_discovered = root
					owner = {
						is_free_or_tributary_trigger = yes
						NOT = { religion = root }
						NOT = { religion = the_thought }
						NOT = { is_subject_of = root }
						NOT = { overlord_of = root }
						NOT = { alliance_with = root }
						NOT = { ROOT = { truce_with = prev } }
						OR = {
							is_part_of_hre = no
							NOT = { hre_reform_passed = landfriede }
							ROOT = { is_part_of_hre = no }
						}
					}
					NOT = { religion = secondary }
				}
				save_event_target_as = agenda_province
				owner = { save_event_target_as = agenda_country }
			}
		}
	}
	immediate_effect = {
		if = {
			limit = {
				event_target:agenda_province = {
					OR = {
						AND = {
							NOT = { is_claim = root }
							NOT = { is_core = root }
						}
						any_neighbor_province = {
							owned_by = event_target:agenda_country
							NOT = { is_claim = root }
							NOT = { is_core = root }
							religion = root
						}
					}
				}
			}
			event_target:agenda_province = {
				if = {
					limit = {
						NOT = { is_claim = root }
						NOT = { is_core = root }
					}
					add_claim = root
				}
				every_neighbor_province = {
					limit = {
						owned_by = event_target:agenda_country
						NOT = { is_claim = root }
						NOT = { is_core = root }
						religion = root
					}
					add_claim = root
				}
			}
		}
	}
	provinces_to_highlight = {
		province_id = event_target:agenda_province
	}
	task_requirements = {
		if = {
			limit = {
				has_estate_agenda_auto_completion = {
					estate = estate_lorentish_elite
				}
			}
			has_estate_agenda_auto_completion = {
				estate = estate_lorentish_elite
			}
		}
		else = {
			event_target:agenda_province = {
				custom_trigger_tooltip = {
					tooltip = owned_by_country_of_root_religion
					owner = {
						religion = root
					}
				}
				hidden_trigger = { religion = root }
			}
		}
	}
	fail_if = {
		event_target:agenda_province = {
			NOT = { religion = root }
		}
	}
	task_completed_effect = {
		on_completed_agenda_effect = {
			estate = estate_lorentish_elite
		}
		if = {
			limit = {
				event_target:agenda_province = {
					owned_by = root
				}
			}
			event_target:agenda_province = {
				add_nationalism = -5
			}
		}
		else = {
			custom_tooltip = estate_lorentish_elite_protect_our_culture_effect_tooltip
		}
		add_estate_loyalty = {
			estate = estate_lorentish_elite
			loyalty = 15
		}
	}
	failing_effect = {
		on_failed_agenda_effect = yes
		clr_auto_complete_flag = yes
		add_estate_loyalty_modifier = {
			estate = estate_lorentish_elite
			desc = EST_VAL_AGENDA_DENIED
			loyalty = -5
			duration = 7300
		}
		event_target:agenda_province = {
			if = {
				limit = {
					is_claim = root
					NOT = { is_permanent_claim = root }
				}
				remove_claim = root
			}
			every_neighbor_province = {
				if = {
					limit = {
						owned_by = event_target:agenda_country
						is_claim = root
						NOT = { is_permanent_claim = root }
					}
					remove_claim = root
				}
			}
		}
	}
}

estate_lorentish_elite_discover_X_in_america = {
	can_select = {
		OR = {
			num_of_conquistadors = 1
			num_of_explorers = 1
		}
		num_of_ports = 1
		any_province = {
			range = root
			OR = {
				continent = north_america
				continent = south_america
				continent = new_world
			}
			has_port = yes
			is_wasteland = no
			is_city = no
			NOT = { has_discovered = root }
			area_for_scope_province = {
				type = all
				NOT = { has_discovered = root }
			}
		}
		NOT = { has_country_modifier = colonial_enthusiasm }
	}
	selection_weight = {
		factor = 2.5
		modifier = {
			factor = 2
			OR = {
				tag = A01 #Lorent
				tag = A02 #Deranne
				tag = A21 #Venail
				tag = A33 #Verne
				tag = A11 #Pearlsedge
				tag = A47 #Eborthil
				tag = A29 #Busilar
			}
		}
		modifier = {
			factor = 1.5
			OR = {
				tag = A05 #Reveria
				tag = U08 #Ekha
				tag = A79 #Gnomish Hierarchy
				tag = A09 #Sorncost
			}
		}
		modifier = {
			factor = 1.25
			OR = {
				tag = Z08 #Bjarnrik
				tag = A19 #Portnamm
				tag = A80 #Iochand
				tag = Z10 #Revrhavn
			}
		}
		modifier = {
			factor = 0.5
			NOT = { num_of_colonists = 1 }
		}
		modifier = {
			factor = 2
			num_of_colonists = 2
		}
		modifier = {
			factor = 2
			OR = {
				num_of_conquistadors = 2
				num_of_explorers = 2
			}
		}
	}
	pre_effect = {
		random_province = {
			limit = {
				range = root
				OR = {
					continent = north_america
					continent = south_america
					continent = new_world
				}
				has_port = yes
				is_wasteland = no
				is_city = no
				NOT = { has_discovered = root }
				area_for_scope_province = {
					type = all
					NOT = { has_discovered = root }
				}
			}
			save_event_target_as = agenda_province
		}
	}
	task_requirements = {
		if = {
			limit = {
				has_estate_agenda_auto_completion = {
					estate = estate_lorentish_elite
				}
			}
			has_estate_agenda_auto_completion = {
				estate = estate_lorentish_elite
			}
		}
		else = {
			event_target:agenda_province = {
				area_for_scope_province = {
					custom_trigger_tooltip = {
						tooltip = discovered_by_root
						has_discovered = root
					}
				}
			}
		}
	}
	task_completed_effect = {
		on_completed_agenda_effect = {
			estate = estate_lorentish_elite
		}
		add_estate_loyalty = {
			estate = estate_lorentish_elite
			loyalty = 10
		}
		add_country_modifier = {
			name = colonial_enthusiasm
			duration = 3650
		}
	}
	fail_if = {
		OR = {
			NOT = { num_of_ports = 1 }
			has_not_any_exploration_ideas = yes
		}
	}
	failing_effect = {
		on_failed_agenda_effect = yes
		clr_auto_complete_flag = yes
		add_estate_loyalty_modifier = {
			estate = estate_lorentish_elite
			desc = EST_VAL_AGENDA_DENIED
			loyalty = -5
			duration = 7300
		}
	}
}

estate_lorentish_elite_colonise_X = {
	can_select = {
		num_of_colonists = 1
		num_of_ports = 1
		any_province = {
			range = root
			is_city = no
			is_wasteland = no
			NOT = { has_province_modifier = cant_colonize }
			OR = {
				has_port = yes
				any_neighbor_province = {
					OR = {
						owned_by = root
						owner = {
							is_colonial_nation_of = root
						}
					}
				}
			}
			has_discovered = root
			area_for_scope_province = {
				type = all
				NOT = { owned_by = root }
				NOT = { has_province_modifier = cant_colonize }
				NOT = {
					owner = {
						is_colonial_nation_of = root
					}
				}
			}
			OR = {
				NOT = { colonial_claim_by_anyone_of_religion = root }
				is_religion_grant_colonial_claim = root
			}
			development = 3	#Anbennar - added so it doesnt target unfinished provinces
		}
		NOT = { has_country_modifier = colonial_enthusiasm }
	}
	selection_weight = {
		factor = 2.5
		modifier = {
			factor = 2
			OR = {
				tag = A01 #Lorent
				tag = A02 #Deranne
				tag = A21 #Venail
				tag = A33 #Verne
				tag = A11 #Pearlsedge
				tag = A47 #Eborthil
				tag = A29 #Busilar
			}
		}
		modifier = {
			factor = 1.5
			OR = {
				tag = A05 #Reveria
				tag = U08 #Ekha
				tag = A79 #Gnomish Hierarchy
				tag = A09 #Sorncost
			}
		}
		modifier = {
			factor = 1.25
			OR = {
				tag = Z08 #Bjarnrik
				tag = A19 #Portnamm
				tag = A80 #Iochand
				tag = Z10 #Revrhavn
			}
		}
		modifier = {
			factor = 2
			num_of_colonists = 2
		}
		modifier = {
			factor = 1.5
			any_country = {
				is_colonial_nation_of = root
			}
		}
	}
	pre_effect = {
		random_province = {
			limit = {
				range = root
				is_city = no
				is_wasteland = no
				NOT = { has_province_modifier = cant_colonize }
				OR = {
					has_port = yes
					any_neighbor_province = {
						OR = {
							owned_by = root
							owner = {
								is_colonial_nation_of = root
							}
						}
					}
				}
				has_discovered = root
				area_for_scope_province = {
					type = all
					NOT = { owned_by = root }
					NOT = { has_province_modifier = cant_colonize }
					NOT = {
						owner = {
							is_colonial_nation_of = root
						}
					}
					development = 3
				}
				OR = {
					NOT = { colonial_claim_by_anyone_of_religion = root }
					is_religion_grant_colonial_claim = root
				}
			}
			save_event_target_as = agenda_province
		}
		random_province = {
			limit = {
				range = root
				is_city = no
				is_wasteland = no
				NOT = { has_province_modifier = cant_colonize }
				any_neighbor_province = {
					OR = {
						owned_by = root
						owner = {
							is_colonial_nation_of = root
						}
					}
				}
				has_discovered = root
				area_for_scope_province = {
					type = all
					NOT = { owned_by = root }
					NOT = { has_province_modifier = cant_colonize }
					NOT = {
						owner = {
							is_colonial_nation_of = root
						}
					}
					development = 3
				}
				OR = {
					continent = north_america
					continent = south_america
					continent = new_world
				}
				OR = {
					NOT = { colonial_claim_by_anyone_of_religion = root }
					is_religion_grant_colonial_claim = root
				}
			}
			save_event_target_as = agenda_province
		}
	}
	provinces_to_highlight = {
		area_for_scope_province = {
			province_id = event_target:agenda_province
		}
	}
	task_requirements = {
		if = {
			limit = {
				has_estate_agenda_auto_completion = {
					estate = estate_lorentish_elite
				}
			}
			has_estate_agenda_auto_completion = {
				estate = estate_lorentish_elite
			}
		}
		else = {
			custom_trigger_tooltip = {
				tooltip = estate_lorentish_elite_colonise_X_requirements
				event_target:agenda_province = {
					area_for_scope_province = {
						is_city = yes
						OR = {
							owned_by = root
							owner = {
								is_colonial_nation_of = root
							}
						}
					}
				}
			}
		}
	}
	task_completed_effect = {
		on_completed_agenda_effect = {
			estate = estate_lorentish_elite
		}
		add_estate_loyalty = {
			estate = estate_lorentish_elite
			loyalty = 10
		}
		add_country_modifier = {
			name = colonial_enthusiasm
			duration = 3650
		}
	}
	fail_if = {
		OR = {
			AND = {
				NOT = { num_of_colonists = 1 }
				event_target:agenda_province = {
					NOT = { country_or_non_sovereign_subject_holds = root }
				}
			}
			event_target:agenda_province = {
				NOT = { range = root }
				is_colony = no
				NOT = { country_or_non_sovereign_subject_holds = ROOT }
			}
			event_target:agenda_province = {
				area_for_scope_province = {
					type = all
					is_city = yes
					NOT = { country_or_non_sovereign_subject_holds = root }
				}
			}
		}
	}
	failing_effect = {
		on_failed_agenda_effect = yes
		clr_auto_complete_flag = yes
		add_estate_loyalty_modifier = {
			estate = estate_lorentish_elite
			desc = EST_VAL_AGENDA_DENIED
			loyalty = -5
			duration = 7300
		}
	}
}

estate_lorentish_elite_colonise_more_X = {
	can_select = {
		num_of_colonists = 1
		num_of_ports = 1
		any_province = {
			range = root
			is_city = no
			NOT = { has_province_modifier = cant_colonize }
			is_wasteland = no
			has_discovered = root
			area_for_scope_province = {
				OR = {
					owned_by = root
					owner = {
						is_colonial_nation_of = root
					}
				}
				is_city = yes
			}
			area_for_scope_province = {
				type = all
				OR = {
					owned_by = root
					owner = {
						is_colonial_nation_of = root
					}
					is_city = no
				}
				development = 3
				NOT = { has_province_modifier = cant_colonize }
			}
			OR = {
				NOT = { colonial_claim_by_anyone_of_religion = root }
				is_religion_grant_colonial_claim = root
			}
		}
		NOT = { has_country_modifier = colonial_enthusiasm }
	}
	selection_weight = {
		factor = 2.5
		modifier = {
			factor = 2
			OR = {
				tag = A01 #Lorent
				tag = A02 #Deranne
				tag = A21 #Venail
				tag = A33 #Verne
				tag = A11 #Pearlsedge
				tag = A47 #Eborthil
				tag = A29 #Busilar
			}
		}
		modifier = {
			factor = 1.5
			OR = {
				tag = A05 #Reveria
				tag = U08 #Ekha
				tag = A79 #Gnomish Hierarchy
				tag = A09 #Sorncost
			}
		}
		modifier = {
			factor = 1.25
			OR = {
				tag = Z08 #Bjarnrik
				tag = A19 #Portnamm
				tag = A80 #Iochand
				tag = Z10 #Revrhavn
			}
		}
		modifier = {
			factor = 2
			num_of_colonists = 2
		}
		modifier = {
			factor = 1.5
			any_country = {
				is_colonial_nation_of = root
			}
		}
	}
	pre_effect = {
		random_province = {
			limit = {
				range = root
				is_city = no
				NOT = { has_province_modifier = cant_colonize }
				is_wasteland = no
				has_discovered = root
				area_for_scope_province = {
					OR = {
						owned_by = root
						owner = {
							is_colonial_nation_of = root
						}
					}
					is_city = yes
				}
				area_for_scope_province = {
					type = all
					OR = {
						owned_by = root
						owner = {
							is_colonial_nation_of = root
						}
						is_city = no
					}
					NOT = { has_province_modifier = cant_colonize }
					development = 3	#Anbennar addition btw
				}
				OR = {
					NOT = { colonial_claim_by_anyone_of_religion = root }
					is_religion_grant_colonial_claim = root
				}
				development = 3
			}
			save_event_target_as = agenda_province
			area = {
				limit = {
					OR = {
						owned_by = root
						owner = {
							is_colonial_nation_of = root
						}
					}
					is_city = yes
				}
				save_event_target_as = agenda_owned_province
			}
		}
	}
	provinces_to_highlight = {
		area_for_scope_province = {
			province_id = event_target:agenda_province
		}
		OR = {
			is_city = no
			owner = {
				NOT = { tag = root }
				NOT = { is_colonial_nation_of = root }
			}
		}
	}
	task_requirements = {
		if = {
			limit = {
				has_estate_agenda_auto_completion = {
					estate = estate_lorentish_elite
				}
			}
			has_estate_agenda_auto_completion = {
				estate = estate_lorentish_elite
			}
		}
		else = {
			custom_trigger_tooltip = {
				tooltip = estate_lorentish_elite_colonise_more_X_requirements
				event_target:agenda_province = {
					area_for_scope_province = {
						type = all
						is_city = yes
						OR = {
							owned_by = root
							owner = {
								is_colonial_nation_of = root
							}
						}
					}
				}
			}
		}
	}
	task_completed_effect = {
		on_completed_agenda_effect = {
			estate = estate_lorentish_elite
		}
		add_estate_loyalty = {
			estate = estate_lorentish_elite
			loyalty = 10
		}
		add_country_modifier = {
			name = colonial_enthusiasm
			duration = 3650
		}
	}
	fail_if = {
		event_target:agenda_province = {
			area_for_scope_province = {
				is_city = yes
				NOT = { owned_by = root }
				NOT = {
					owner = {
						is_colonial_nation_of = root
					}
				}
			}
		}
	}
	failing_effect = {
		on_failed_agenda_effect = yes
		clr_auto_complete_flag = yes
		add_estate_loyalty_modifier = {
			estate = estate_lorentish_elite
			desc = EST_VAL_AGENDA_DENIED
			loyalty = -5
			duration = 7300
		}
	}
}

estate_lorentish_elite_colonial_nation = {
	can_select = {
		num_of_colonists = 1
		num_of_ports = 1
		#Anbennar
		NOT = {
			capital_scope = {
				OR = {
					continent = north_america
					continent = south_america
					continent = new_world
				}
			}
		}
		#
		any_owned_province = {
			OR = {
				continent = north_america
				continent = south_america
				continent = new_world
			}
			NOT = {
				calc_true_if = {
					amount = 5
					colonial_region_for_scope_province = {
						type = all
						country_or_non_sovereign_subject_holds = root
					}
				}
			}
			calc_true_if = {
				amount = 3
				colonial_region_for_scope_province = {
					type = all
					country_or_non_sovereign_subject_holds = root
					is_city = yes
				}
			}
			OR = {
				NOT = { colonial_claim_by_anyone_of_religion = root }
				is_religion_grant_colonial_claim = root
			}
		}
		NOT = { has_country_modifier = agenda_colonial_administration }
	}
	selection_weight = {
		factor = 2.5
		modifier = {
			factor = 2
			OR = {
				tag = A01 #Lorent
				tag = A02 #Deranne
				tag = A21 #Venail
				tag = A33 #Verne
				tag = A11 #Pearlsedge
				tag = A47 #Eborthil
				tag = A29 #Busilar
			}
		}
		modifier = {
			factor = 1.5
			OR = {
				tag = A05 #Reveria
				tag = U08 #Ekha
				tag = A79 #Gnomish Hierarchy
				tag = A09 #Sorncost
			}
		}
		modifier = {
			factor = 1.25
			OR = {
				tag = Z08 #Bjarnrik
				tag = A19 #Portnamm
				tag = A80 #Iochand
				tag = Z10 #Revrhavn
			}
		}
		modifier = {
			factor = 2
			num_of_colonists = 2
		}
		modifier = {
			factor = 1.5
			any_country = {
				is_colonial_nation_of = root
			}
		}
	}
	pre_effect = {
		random_owned_province = {
			limit = {
				OR = {
					continent = north_america
					continent = south_america
					continent = new_world
				}
				NOT = {
					calc_true_if = {
						amount = 5
						colonial_region_for_scope_province = {
							type = all
							country_or_non_sovereign_subject_holds = root
						}
					}
				}
				calc_true_if = {
					amount = 3
					colonial_region_for_scope_province = {
						type = all
						country_or_non_sovereign_subject_holds = root
						is_city = yes
					}
				}
				OR = {
					NOT = { colonial_claim_by_anyone_of_religion = root }
					is_religion_grant_colonial_claim = root
				}
			}
			save_event_target_as = agenda_province
		}
	}
	provinces_to_highlight = {
		colonial_region = event_target:agenda_province
	}
	task_requirements = {
		if = {
			limit = {
				has_estate_agenda_auto_completion = {
					estate = estate_lorentish_elite
				}
			}
			has_estate_agenda_auto_completion = {
				estate = estate_lorentish_elite
			}
		}
		else_if = {
			limit = { is_colonial_nation = yes }
			grown_by_development = 50 
		}
		else = {
			custom_trigger_tooltip = {
				tooltip = estate_lorentish_elite_colonial_nation_requirements_tooltip
				any_subject_country = {
					is_colonial_nation_of = root
					capital_scope = { colonial_region = event_target:agenda_province }
					num_of_cities = 5
				}
			}
		}
	}
	task_completed_effect = {
		on_completed_agenda_effect = {
			estate = estate_lorentish_elite
		}
		add_estate_loyalty = {
			estate = estate_lorentish_elite
			loyalty = 10
		}
		add_country_modifier = {
			name = agenda_colonial_administration
			duration = 5475
		}
	}
	failing_effect = {
		on_failed_agenda_effect = yes
		clr_auto_complete_flag = yes
		add_estate_loyalty_modifier = {
			estate = estate_lorentish_elite
			desc = EST_VAL_AGENDA_DENIED
			loyalty = -5
			duration = 7300
		}
	}
}

estate_lorentish_elite_expand_trade_company = {
	can_select = {
		num_of_ports = 1
		any_owned_province = {
			#NOT = { area = laponia_area }
			is_owned_by_trade_company = yes
			NOT = { trade_company_size = 10 }
		}
	}
	selection_weight = {
		factor = 2.5
		#modifier = { #invalid tags
		#	factor = 2
		#	OR = {
		#		tag = POR
		#		tag = CAS
		#		tag = GBR
		#		tag = NED
		#	}
		#}
		modifier = {
			factor = 1.5
			num_of_colonists = 1
		}
		modifier = {
			factor = 2
			num_of_trade_companies = 2
		}
		modifier = {
			factor = 2
			num_of_strong_trade_companies = 2
		}
	}
	pre_effect = {
		set_variable = {
			which = estate_lorentish_elite_expand_trade_company_variable
			value = 0
		}
		random_owned_province = {
			limit = {
				is_owned_by_trade_company = yes
				NOT = { trade_company_size = 10 }
			}
			save_event_target_as = agenda_province

			if = {
				limit = {
					NOT = { trade_company_size = 4 }
				}
				root = {
					set_variable = {
						which = estate_lorentish_elite_expand_trade_company_variable
						value = 1
					}
				}
			}
			else_if = {
				limit = {
					NOT = { trade_company_size = 6 }
				}
				root = {
					set_variable = {
						which = estate_lorentish_elite_expand_trade_company_variable
						value = 2
					}
				}
			}
			else = {
				root = {
					set_variable = {
						which = estate_lorentish_elite_expand_trade_company_variable
						value = 3
					}
				}
			}
		}
	}
	provinces_to_highlight = {
		trade_company_region = event_target:agenda_province
	}
	task_requirements = {
		if = {
			limit = {
				has_estate_agenda_auto_completion = {
					estate = estate_lorentish_elite
				}
			}
			has_estate_agenda_auto_completion = {
				estate = estate_lorentish_elite
			}
		}
		else = {
			if = {
				limit = {
					check_variable = {
						which = estate_lorentish_elite_expand_trade_company_variable
						value = 3
					}
				}
				event_target:agenda_province = {
					trade_company_size = 10
				}
			}
			else_if = {
				limit = {
					check_variable = {
						which = estate_lorentish_elite_expand_trade_company_variable
						value = 2
					}
				}
				event_target:agenda_province = {
					trade_company_size = 8
				}
			}
			else = {
				event_target:agenda_province = {
					trade_company_size = 5
				}
			}
		}
	}
	task_completed_effect = {
		on_completed_agenda_effect = {
			estate = estate_lorentish_elite
		}
		add_estate_loyalty = {
			estate = estate_lorentish_elite
			loyalty = 15
		}
	}
	failing_effect = {
		on_failed_agenda_effect = yes
		clr_auto_complete_flag = yes
		add_estate_loyalty_modifier = {
			estate = estate_lorentish_elite
			desc = EST_VAL_AGENDA_DENIED
			loyalty = -5
			duration = 7300
		}
	}
}

estate_lorentish_elite_protect_against_piracy = {
	can_select = {
		any_active_trade_node = {
			trade_share = {
				country = root
				share = 20
			}
			privateer_power = {
				share = 20
			}
			NOT = {
				privateer_power = {
					share = 1
					country = root
				}
			}
		}
	}
	selection_weight = {
		factor = 2
		modifier = {
			factor = 2
			any_active_trade_node = {
				trade_share = {
					country = root
					share = 20
				}
				privateer_power = {
					share = 20
				}
				NOT = {
					privateer_power = {
						share = 1
						country = root
					}
				}
				OR = {
					trade_share = {
						country = root
						share = 35
					}
					privateer_power = {
						share = 35
					}
				}
			}
		}
	}
	pre_effect = {
		random_active_trade_node = {
			limit = {
				trade_share = {
					country = root
					share = 20
				}
				privateer_power = {
					share = 20
				}
				NOT = {
					privateer_power = {
						share = 1
						country = root
					}
				}
			}
			save_event_target_as = agenda_trade_node
		}
		random_active_trade_node = {
			limit = {
				trade_share = {
					country = root
					share = 20
				}
				privateer_power = {
					share = 20
				}
				NOT = {
					privateer_power = {
						share = 1
						country = root
					}
				}
				OR = {
					trade_share = {
						country = root
						share = 35
					}
					privateer_power = {
						share = 35
					}
				}
			}
			save_event_target_as = agenda_trade_node
			if = {
				limit = {
					OR = {
						is_sea = yes
						has_port = no #shouldn't ever be the case, but just in case...
					}
				}
				save_event_target_as = agenda_trade_node_sea
			}
			else = {
				sea_zone = {
					save_event_target_as = agenda_trade_node_sea
				}
			}
		}
	}
	provinces_to_highlight = {
		province_id = event_target:agenda_trade_node
	}
	task_requirements = {
		if = {
			limit = {
				has_estate_agenda_auto_completion = {
					estate = estate_lorentish_elite
				}
			}
			has_estate_agenda_auto_completion = {
				estate = estate_lorentish_elite
			}
		}
		else = {
			event_target:agenda_trade_node = {
				trade_share = {
					country = root
					share = 20
				}
			}
			NOT = {
				any_country = {
					event_target:agenda_trade_node = {
						privateer_power = {
							share = 3
							country = PREV
						}
					}
				}
			}
		}
	}
	fail_if = {
		event_target:agenda_trade_node = {
			NOT = {
				trade_share = {
					country = root
					share = 10
				}
			}
		}
	}
	task_completed_effect = {
		on_completed_agenda_effect = {
			estate = estate_lorentish_elite
		}
		add_estate_loyalty = {
			estate = estate_lorentish_elite
			loyalty = 15
		}
	}
	failing_effect = {
		on_failed_agenda_effect = yes
		clr_auto_complete_flag = yes
		add_estate_loyalty_modifier = {
			estate = estate_lorentish_elite
			desc = EST_VAL_AGENDA_DENIED
			loyalty = -5
			duration = 7300
		}
	}
}

estate_lorentish_elite_hire_advisor = {
	can_select = {
		NOT = {
			employed_advisor = {
				culture = ruby_dwarf
			}
			employed_advisor = {
				culture = high_lorentish_dual
			}
			employed_advisor = {
				culture = high_lorentish
			}
			employed_advisor = {
				culture = low_lorentish
			}
		}
	}
	selection_weight = {
		factor = 1
	}
	task_requirements = {
		if = {
			limit = {
				has_estate_agenda_auto_completion = {
					estate = estate_lorentish_elite
				}
			}
			has_estate_agenda_auto_completion = {
				estate = estate_lorentish_elite
			}
		}
		else = {
			OR = {
				employed_advisor = {
					culture = ruby_dwarf
				}
				employed_advisor = {
					culture = high_lorentish_dual
				}
				employed_advisor = {
					culture = high_lorentish
				}
				employed_advisor = {
					culture = low_lorentish
				}
			}
		}
	}
	task_completed_effect = {
		on_completed_agenda_effect = {
			estate = estate_lorentish_elite
		}
		add_estate_loyalty = {
			estate = estate_lorentish_elite
			loyalty = 10
		}
	}
	failing_effect = {
		on_failed_agenda_effect = yes
		clr_auto_complete_flag = yes
		add_estate_loyalty_modifier = {
			estate = estate_lorentish_elite
			desc = EST_VAL_AGENDA_DENIED
			loyalty = -5
			duration = 7300
		}
	}
}

estate_lorentish_elite_crush_revolts = {
	can_select = {
		num_of_rebel_armies = 1
		NOT = {
			has_spawned_rebels = noble_rebels
			has_spawned_rebels = polish_noble_rebels
			#Clergy agenda covers heretic rebels
			has_spawned_rebels = heretic_rebels
			has_spawned_rebels = lollard_rebels
		}
	}
	selection_weight = {
		factor = 2
		modifier = {
			factor = 2
			num_of_rebel_controlled_provinces = 3
		}
		modifier = {
			factor = 2
			num_of_rebel_controlled_provinces = 5
		}
	}
	provinces_to_highlight = {
		owned_by = root
		controlled_by = REB
	}
	fail_if = {
		has_country_modifier = just_lost_to_rebels
	}
	task_requirements = {
		if = {
			limit = {
				has_estate_agenda_auto_completion = {
					estate = estate_lorentish_elite
				}
			}
			has_estate_agenda_auto_completion = {
				estate = estate_lorentish_elite
			}
		}
		else = {
			NOT = { num_of_rebel_controlled_provinces = 1 }
			NOT = { num_of_rebel_armies = 1 }
			hidden_trigger = { NOT = { has_country_modifier = just_lost_to_rebels } }
		}
	}
	task_completed_effect = {
		on_completed_agenda_effect = {
			estate = estate_lorentish_elite
		}
		add_estate_loyalty = {
			estate = estate_lorentish_elite
			loyalty = 10
		}
		add_prestige = 10
	}
	failing_effect = {
		on_failed_agenda_effect = yes
		clr_auto_complete_flag = yes
		add_estate_loyalty_modifier = {
			estate = estate_lorentish_elite
			desc = EST_VAL_AGENDA_DENIED
			loyalty = -5
			duration = 7300
		}
	}
}

estate_lorentish_elite_convert_province_culture = {
	can_select = {
		any_owned_province = {
			NOT = { culture_is_high_lorentish = yes }
			has_owner_accepted_culture = no
			NOT = { nationalism = 1 }
			religion = root
			any_neighbor_province = {
				owned_by = root
				culture = root
			}
		}
	}
	selection_weight = {
		factor = 1
		modifier = {
			factor = 0.75
			always = yes
		}
	}
	pre_effect = {
		random_owned_province = {
			limit = {
				NOT = { culture_is_high_lorentish = yes }
				has_owner_accepted_culture = no
				NOT = { nationalism = 1 }
				religion = root
				any_neighbor_province = {
					owned_by = root
					culture = root
				}
			}
			save_event_target_as = agenda_province
			choose_random_development_bonus_effect = yes
		}
	}
	fail_if = {
		event_target:agenda_province = {
			OR = {
				NOT = { owned_by = root }
				nationalism = 1
				NOT = { religion = root }
			}
		}
	}
	immediate_effect = {
		event_target:agenda_province = {
			add_province_modifier = {
				name = agenda_cultural_conversion_help
				duration = 7300
			}
		}
	}
	on_invalid = {
		event_target:agenda_province = {
			clear_random_development_bonus_flags_effect = yes
			if = {
				limit = {
					has_province_modifier = agenda_cultural_conversion_help
				}
				remove_province_modifier = agenda_cultural_conversion_help
			}
		}
	}
	provinces_to_highlight = {
		province_id = event_target:agenda_province
	}
	task_requirements = {
		if = {
			limit = {
				has_estate_agenda_auto_completion = {
					estate = estate_lorentish_elite
				}
			}
			has_estate_agenda_auto_completion = {
				estate = estate_lorentish_elite
			}
		}
		else = {
			if = {
				limit = {
					NOT = {
						event_target:agenda_province = {
							has_owner_accepted_culture = yes
						}
					}
				}
				event_target:agenda_province = {
					culture_is_high_lorentish = yes
				}
			}
			else = { #don't want to show this in most cases, but don't want it to count as a fail if you do this.
				event_target:agenda_province = {
					has_owner_accepted_culture = yes
				}
			}
		}
	}
	task_completed_effect = {
		on_completed_agenda_effect = {
			estate = estate_lorentish_elite
		}
		add_estate_loyalty = {
			estate = estate_lorentish_elite
			loyalty = 10
		}
		event_target:agenda_province = {
			apply_random_development_bonus_bonus_effect = yes
		}
		hidden_effect = {
			event_target:agenda_province = {
				if = {
					limit = {
						has_province_modifier = agenda_cultural_conversion_help
					}
					remove_province_modifier = agenda_cultural_conversion_help
				}
			}
		}
	}
	failing_effect = {
		on_failed_agenda_effect = yes
		clr_auto_complete_flag = yes
		add_estate_loyalty_modifier = {
			estate = estate_lorentish_elite
			desc = EST_VAL_AGENDA_DENIED
			loyalty = -5
			duration = 7300
		}
		event_target:agenda_province = {
			clear_random_development_bonus_flags_effect = yes
			if = {
				limit = {
					has_province_modifier = agenda_cultural_conversion_help
				}
				remove_province_modifier = agenda_cultural_conversion_help
			}
		}
	}
}

estate_lorentish_elite_protect_our_culture = {
	can_select = {
		is_free_or_tributary_trigger = yes
		is_at_war = no
		any_neighbor_country = {
			NOT = { culture_group = root }
			any_owned_province = {
				OR = {
					culture = root
					culture_is_high_lorentish = yes
				}
				religion = root
			}
		}
		any_owned_province = {
			any_neighbor_province = {
				is_city = yes
				religion = root
				OR = {
					culture = root
					culture_is_high_lorentish = yes
				}
				has_owner_culture = no
				has_owner_accepted_culture = no
				has_discovered = root
				owner = {
					is_free_or_tributary_trigger = yes
					NOT = { culture_group = prev }
					NOT = { is_subject_of = root }
					NOT = { overlord_of = root }
					NOT = { alliance_with = root }
					NOT = { ROOT = { truce_with = prev } }
					OR = {
						is_part_of_hre = no
						NOT = { hre_reform_passed = landfriede }
						ROOT = { is_part_of_hre = no }
					}
				}
			}
		}
	}
	selection_weight = {
		factor = 1.5
		modifier = {
			factor = 0.25
			any_country = {
				coalition_target = root
			}
		}
	}
	pre_effect = {
		random_owned_province = {
			limit = {
				any_neighbor_province = {
					is_city = yes
					religion = root
					OR = {
						culture = root
						culture_is_high_lorentish = yes
					}
					has_owner_culture = no
					has_owner_accepted_culture = no
					has_discovered = root
					owner = {
						is_free_or_tributary_trigger = yes
						NOT = { culture_group = prev }
						NOT = { is_subject_of = root }
						NOT = { overlord_of = root }
						NOT = { alliance_with = root }
						NOT = { ROOT = { truce_with = prev } }
						OR = {
							is_part_of_hre = no
							NOT = { hre_reform_passed = landfriede }
							ROOT = { is_part_of_hre = no }
						}
					}
				}
			}
			random_neighbor_province = {
				limit = {
					is_city = yes
					religion = root
					OR = {
						culture = root
						culture_is_high_lorentish = yes
					}
					has_owner_culture = no
					has_owner_accepted_culture = no
					has_discovered = root
					owner = {
						is_free_or_tributary_trigger = yes
						NOT = { culture_group = prev }
						NOT = { is_subject_of = root }
						NOT = { overlord_of = root }
						NOT = { alliance_with = root }
						NOT = { ROOT = { truce_with = prev } }
						OR = {
							is_part_of_hre = no
							NOT = { hre_reform_passed = landfriede }
							ROOT = { is_part_of_hre = no }
						}
					}
				}
				save_event_target_as = agenda_province
				owner = { save_event_target_as = agenda_country }
			}
		}
	}
	immediate_effect = {
		if = {
			limit = {
				event_target:agenda_province = {
					OR = {
						AND = {
							NOT = { is_claim = root }
							NOT = { is_core = root }
						}
						any_neighbor_province = {
							owned_by = event_target:agenda_country
							NOT = { is_claim = root }
							NOT = { is_core = root }
							OR = {
								culture = root
								culture_is_high_lorentish = yes
							}
						}
					}
				}
			}
			event_target:agenda_province = {
				if = {
					limit = {
						NOT = { is_claim = root }
						NOT = { is_core = root }
					}
					add_claim = root
				}
				every_neighbor_province = {
					limit = {
						owned_by = event_target:agenda_country
						NOT = { is_claim = root }
						NOT = { is_core = root }
						culture = root
					}
					add_claim = root
				}
			}
		}
	}
	on_invalid = {
		event_target:agenda_province = {
			if = {
				limit = {
					is_claim = root
					NOT = { is_permanent_claim = root }
				}
				remove_claim = root
			}
			every_neighbor_province = {
				if = {
					limit = {
						owned_by = event_target:agenda_country
						NOT = { is_permanent_claim = root }
						is_claim = root
					}
					remove_claim = root
				}
			}
		}
	}
	provinces_to_highlight = {
		province_id = event_target:agenda_province
	}
	task_requirements = {
		if = {
			limit = {
				has_estate_agenda_auto_completion = {
					estate = estate_lorentish_elite
				}
			}
			has_estate_agenda_auto_completion = {
				estate = estate_lorentish_elite
			}
		}
		else = {
			event_target:agenda_province = {
				owner = {
					primary_culture = root
				}
				hidden_trigger = { culture = root }
			}
		}
	}
	fail_if = {
		event_target:agenda_province = {
			NOT = { culture = root }
		}
	}
	task_completed_effect = {
		on_completed_agenda_effect = {
			estate = estate_lorentish_elite
		}
		if = {
			limit = {
				event_target:agenda_province = {
					owned_by = root
				}
			}
			event_target:agenda_province = {
				add_nationalism = -5
			}
		}
		else = { custom_tooltip = estate_lorentish_elite_protect_our_culture_effect_tooltip }
		add_estate_loyalty = {
			estate = estate_lorentish_elite
			loyalty = 15
		}
	}
	failing_effect = {
		on_failed_agenda_effect = yes
		clr_auto_complete_flag = yes
		add_estate_loyalty_modifier = {
			estate = estate_lorentish_elite
			desc = EST_VAL_AGENDA_DENIED
			loyalty = -5
			duration = 7300
		}
		event_target:agenda_province = {
			if = {
				limit = {
					is_claim = root
					NOT = { is_permanent_claim = root }
				}
				remove_claim = root
			}
			every_neighbor_province = {
				if = {
					limit = {
						owned_by = event_target:agenda_country
						NOT = { is_permanent_claim = root }
						is_claim = root
					}
					remove_claim = root
				}
			}
		}
	}
}

estate_lorentish_elite_vassalise_vulnerable_country = {
	can_select = {
		is_free_or_tributary_trigger = yes
		is_at_war = no
		num_of_cities = 12
		any_neighbor_country = {
			capital_scope = {
				OR = {
					region = lencenor_region
					region = west_dameshead_region
					region = small_country_region
					region = dragon_coast_region
				}
			}
			NOT = { has_reform = free_city }
			is_free_or_tributary_trigger = yes
			OR = {
				NOT = { num_of_cities = 4 }
				NOT = { total_development = 100 }
			}
			OR = {
				NOT = { num_of_cities = 3 }
				NOT = { total_development = 50 }
				ROOT = { total_development = 500 }
			}
			NOT = { is_subject_of = root }
			NOT = { overlord_of = root }
			NOT = { alliance_with = root }
			NOT = { ROOT = { truce_with = prev } }
			NOT = {
				has_opinion = {
					who = root
					value = 100
				}
			}
			OR = {
				is_part_of_hre = no
				NOT = { hre_reform_passed = landfriede }
				ROOT = { is_part_of_hre = no }
			}
			any_owned_province = {
				NOT = { is_claim = root }
				NOT = { is_core = root }
			}
		}
		NOT = { has_country_modifier = foreign_contacts }
	}
	selection_weight = {
		factor = 2
		modifier = {
			factor = 0.5
			has_non_generic_missions = yes
		}
		modifier = {
			factor = 1.5
			num_of_cities = 20
		}
		modifier = {
			factor = 1.5
			num_of_cities = 25
		}
		modifier = {
			factor = 1.5
			num_of_cities = 30
		}
		modifier = {
			factor = 1.5
			num_of_cities = 40
		}
		modifier = {
			factor = 1.5
			num_of_cities = 50
		}
		modifier = {
			factor = 0.25
			any_country = {
				coalition_target = root
			}
		}
	}
	pre_effect = {
		random_neighbor_country = {
			limit = {
				capital_scope = {
					OR = {
						region = lencenor_region
						region = west_dameshead_region
						region = small_country_region
						region = dragon_coast_region
					}
				}
				NOT = { has_reform = free_city }
				is_free_or_tributary_trigger = yes
				OR = {
					NOT = { num_of_cities = 4 }
					NOT = { total_development = 100 }
				}
				OR = {
					NOT = { num_of_cities = 3 }
					NOT = { total_development = 50 }
					ROOT = { total_development = 500 }
				}
				NOT = { is_subject_of = root }
				NOT = { overlord_of = root }
				NOT = { alliance_with = root }
				NOT = { ROOT = { truce_with = prev } }
				NOT = {
					has_opinion = {
						who = root
						value = 100
					}
				}
				OR = {
					is_part_of_hre = no
					NOT = { hre_reform_passed = landfriede }
					ROOT = { is_part_of_hre = no }
				}
				any_owned_province = {
					NOT = { is_claim = root }
					NOT = { is_core = root }
				}
			}
			save_event_target_as = agenda_country
			capital_scope = {
				save_event_target_as = agenda_province
			}
		}
	}
	immediate_effect = {
		add_casus_belli = {
			type = cb_vassalize_mission
			months = 240
			target = event_target:agenda_country
		}
	}
	on_invalid = {
		if = {
			limit = {
				has_casus_belli = {
					type = cb_vassalize_mission
					target = event_target:agenda_country
				}
			}
			remove_casus_belli = {
				type = cb_vassalize_mission
				target = event_target:agenda_country
			}
		}
	}
	provinces_to_highlight = {
		is_capital_of = event_target:agenda_country
	}
	task_requirements = {
		if = {
			limit = {
				has_estate_agenda_auto_completion = {
					estate = estate_lorentish_elite
				}
			}
			has_estate_agenda_auto_completion = {
				estate = estate_lorentish_elite
			}
		}
		else = {
			event_target:agenda_country = {
				is_subject_of = root
			}
		}
	}
	fail_if = {
		OR = {
			is_subject_other_than_tributary_trigger = yes
			event_target:agenda_country = {
				NOT = { num_of_cities = 1 }
			}
		}
	}
	task_completed_effect = {
		on_completed_agenda_effect = {
			estate = estate_lorentish_elite
		}
		add_estate_loyalty = {
			estate = estate_lorentish_elite
			loyalty = 10
		}
		add_country_modifier = {
			name = foreign_contacts
			duration = 3650
		}
		hidden_effect = {
			remove_casus_belli = {
				type = cb_vassalize_mission
				target = event_target:agenda_country
			}
		}
	}
	failing_effect = {
		on_failed_agenda_effect = yes
		clr_auto_complete_flag = yes
		add_estate_loyalty_modifier = {
			estate = estate_lorentish_elite
			desc = EST_VAL_AGENDA_DENIED
			loyalty = -5
			duration = 7300
		}
		if = {
			limit = {
				has_casus_belli = {
					type = cb_vassalize_mission
					target = event_target:agenda_country
				}
			}
			remove_casus_belli = {
				type = cb_vassalize_mission
				target = event_target:agenda_country
			}
		}
	}
}

estate_lorentish_elite_expand_into_x = {
	can_select = {
		is_free_or_tributary_trigger = yes
		is_at_war = no
		any_neighbor_country = {
			capital_scope = {
				OR = {
					region = lencenor_region
					region = west_dameshead_region
					region = small_country_region
					region = dragon_coast_region
				}
			}
			num_of_cities = 6
			is_free_or_tributary_trigger = yes
			NOT = { is_subject_of = root }
			NOT = { overlord_of = root }
			NOT = { alliance_with = root }
			NOT = { ROOT = { truce_with = prev } }
			NOT = { 
				has_opinion = {
					who = root
					value = 25
				}
			}
			NOT = {
				any_owned_province = { #No need for this agenda if covered by a mission
					OR = {
						is_permanent_claim = root
						is_core = root
					}
				}
			}
			ROOT = {
				knows_country = prev
			}
			any_owned_province = {
				any_neighbor_province = {
					owned_by = root
				}
				NOT = {
					area_for_scope_province = {
						OR = {
							is_empty = yes
							owned_by = root
						}
					}
				}
			}
			OR = {
				is_part_of_hre = no
				NOT = { hre_reform_passed = landfriede }
				ROOT = { is_part_of_hre = no }
			}
		}
	}
	selection_weight = {
		factor = 2
		modifier = {
			factor = 0.5
			has_non_generic_missions = yes
		}
		modifier = {
			factor = 1.5
			num_of_cities = 20
		}
		modifier = {
			factor = 1.5
			num_of_cities = 25
		}
		modifier = {
			factor = 1.5
			num_of_cities = 30
		}
		modifier = {
			factor = 1.5
			num_of_cities = 40
		}
		modifier = {
			factor = 1.5
			num_of_cities = 50
		}
		modifier = {
			factor = 0.25
			any_country = {
				coalition_target = root
			}
		}
	}
	pre_effect = {
		random_neighbor_country = {
			limit = {
				capital_scope = {
					OR = {
						region = lencenor_region
						region = west_dameshead_region
						region = small_country_region
						region = dragon_coast_region
					}
				}
				num_of_cities = 6
				is_free_or_tributary_trigger = yes
				NOT = { is_subject_of = root }
				NOT = { overlord_of = root }
				NOT = { alliance_with = root }
				NOT = { ROOT = { truce_with = prev } }
				NOT = { 
					has_opinion = {
						who = root
						value = 25
					}
				}
				NOT = {
					any_owned_province = { #No need for this agenda if covered by a mission
						OR = {
							is_permanent_claim = root
							is_core = root
						}
					}
				}
				ROOT = {
					knows_country = prev
				}
				any_owned_province = {
					any_neighbor_province = {
						owned_by = root
					}
					NOT = {
						area_for_scope_province = {
							OR = {
								is_empty = yes
								owned_by = root
							}
						}
					}
				}
				OR = {
					is_part_of_hre = no
					NOT = { hre_reform_passed = landfriede }
					ROOT = { is_part_of_hre = no }
				}
			}
			random_owned_province = {
				limit = {
					any_neighbor_province = {
						owned_by = root
					}
					area_for_scope_province = {
						type = all
						NOT = { owned_by = root }
						is_empty = no
					}
				}
				save_event_target_as = agenda_province
			}
		}
	}
	immediate_effect = {
		if = {
			limit = {
				event_target:agenda_province = {
					area_for_scope_province = {
						NOT = { is_claim = root }
						NOT = { is_core = root }
					}
				}
			}
			event_target:agenda_province = {
				area = {
					limit = {
						NOT = { is_claim = root }
						NOT = { is_core = root }
					}
					add_claim = root
				}
			}
		}
	}
	on_invalid = {
		if = {
			limit = {
				event_target:agenda_province = {
					area_for_scope_province = {
						is_claim = root
						NOT = { is_permanent_claim = root }
					}
				}
			}
			event_target:agenda_province = {
				area = {
					limit = {
						is_claim = root
						NOT = { is_permanent_claim = root }
					}
					remove_claim = root
				}
			}
		}
	}
	provinces_to_highlight = {
		area_for_scope_province = {
			province_id = event_target:agenda_province
		}
	}
	task_requirements = {
		if = {
			limit = {
				has_estate_agenda_auto_completion = {
					estate = estate_lorentish_elite
				}
			}
			has_estate_agenda_auto_completion = {
				estate = estate_lorentish_elite
			}
		}
		else = {
			event_target:agenda_province = {
				area_for_scope_province = {
					owned_by = root
				}
			}
		}
	}
	fail_if = {
		event_target:agenda_province = {
			area_for_scope_province = {
				type = all
				NOT = { is_claim = root }
				NOT = { is_core = root }
				NOT = { owned_by = root }
			}
		}
	}
	task_completed_effect = {
		on_completed_agenda_effect = {
			estate = estate_lorentish_elite
		}
		add_estate_loyalty = {
			estate = estate_lorentish_elite
			loyalty = 15
		}
		add_adm_power = 50
	}
	failing_effect = {
		on_failed_agenda_effect = yes
		clr_auto_complete_flag = yes
		add_estate_loyalty_modifier = {
			estate = estate_lorentish_elite
			desc = EST_VAL_AGENDA_DENIED
			loyalty = -5
			duration = 7300
		}
		if = {
			limit = {
				event_target:agenda_province = {
					area_for_scope_province = {
						is_claim = root
						NOT = { is_permanent_claim = root }
					}
				}
			}
			event_target:agenda_province = {
				area = {
					limit = {
						is_claim = root
						NOT = { is_permanent_claim = root }
					}
					remove_claim = root
				}
			}
		}
	}
}

estate_lorentish_elite_complete_conquest_of_x = {
	can_select = {
		is_free_or_tributary_trigger = yes
		is_at_war = no
		any_neighbor_country = {
			capital_scope = {
				OR = {
					region = lencenor_region
					region = west_dameshead_region
					region = small_country_region
					region = dragon_coast_region
				}
			}
			num_of_cities = 6
			is_free_or_tributary_trigger = yes
			NOT = { is_subject_of = root }
			NOT = { overlord_of = root }
			NOT = { alliance_with = root }
			NOT = { ROOT = { truce_with = prev } }
			NOT = { 
				has_opinion = {
					who = root
					value = 25
				}
			}
			NOT = {
				any_owned_province = { #No need for this agenda if covered by a mission
					OR = {
						is_permanent_claim = root
						is_core = root
					}
				}
			}
			ROOT = {
				knows_country = prev
			}
			any_owned_province = {
				any_neighbor_province = {
					owned_by = root
				}
				area_for_scope_province = {
					owned_by = root
				}
				NOT = {
					area_for_scope_province = {
						owner = {
							OR = {
								alliance_with = root
								ROOT = { truce_with = prev }
								is_subject_of = root
								AND = {
									is_part_of_hre = yes
									hre_reform_passed = landfriede
								}
							}
						}
					}
				}
			}
		}
	}
	selection_weight = {
		factor = 2.5
		modifier = {
			factor = 0.5
			has_non_generic_missions = yes
		}
		modifier = {
			factor = 1.5
			num_of_cities = 20
		}
		modifier = {
			factor = 1.5
			num_of_cities = 25
		}
		modifier = {
			factor = 1.5
			num_of_cities = 30
		}
		modifier = {
			factor = 1.5
			num_of_cities = 40
		}
		modifier = {
			factor = 1.5
			num_of_cities = 50
		}
		modifier = {
			factor = 0.25
			any_country = {
				coalition_target = root
			}
		}
	}
	pre_effect = {
		random_neighbor_country = {
			limit = {
				capital_scope = {
					OR = {
						region = lencenor_region
						region = west_dameshead_region
						region = small_country_region
						region = dragon_coast_region
					}
				}
				num_of_cities = 6
				is_free_or_tributary_trigger = yes
				NOT = { is_subject_of = root }
				NOT = { overlord_of = root }
				NOT = { alliance_with = root }
				NOT = { ROOT = { truce_with = prev } }
				NOT = { 
					has_opinion = {
						who = root
						value = 25
					}
				}
				NOT = {
					any_owned_province = { #No need for this agenda if covered by a mission
						OR = {
							is_permanent_claim = root
							is_core = root
						}
					}
				}
				ROOT = {
					knows_country = prev
				}
				any_owned_province = {
					any_neighbor_province = {
						owned_by = root
					}
					area_for_scope_province = {
						owned_by = root
					}
					NOT = {
						area_for_scope_province = {
							owner = {
								OR = {
									alliance_with = root
									ROOT = { truce_with = prev }
									is_subject_of = root
									AND = {
										is_part_of_hre = yes
										hre_reform_passed = landfriede
									}
								}
							}
						}
					}
				}
			}
			random_owned_province = {
				limit = {
					any_neighbor_province = {
						owned_by = root
					}
					area_for_scope_province = {
						owned_by = root
					}
					NOT = {
						area_for_scope_province = {
							owner = {
								OR = {
									alliance_with = root
									ROOT = { truce_with = prev }
									is_subject_of = root
									AND = {
										is_part_of_hre = yes
										hre_reform_passed = landfriede
									}
								}
							}
						}
					}
				}
				save_event_target_as = agenda_province
			}
		}
	}
	immediate_effect = {
		if = {
			limit = {
				event_target:agenda_province = {
					area_for_scope_province = {
						NOT = { is_claim = root }
						NOT = { is_core = root }
					}
				}
			}
			event_target:agenda_province = {
				area = {
					limit = {
						NOT = { is_claim = root }
						NOT = { is_core = root }
					}
					add_claim = root
				}
			}
		}
	}
	on_invalid = {
		if = {
			limit = {
				event_target:agenda_province = {
					area_for_scope_province = {
						is_claim = root
						NOT = { is_permanent_claim = root }
					}
				}
			}
			event_target:agenda_province = {
				area = {
					limit = {
						is_claim = root
						NOT = { is_permanent_claim = root }
					}
					remove_claim = root
				}
			}
		}
	}
	provinces_to_highlight = {
		area_for_scope_province = {
			province_id = event_target:agenda_province
		}
		NOT = { owned_by = root }
	}
	task_requirements = {
		if = {
			limit = {
				has_estate_agenda_auto_completion = {
					estate = estate_lorentish_elite
				}
			}
			has_estate_agenda_auto_completion = {
				estate = estate_lorentish_elite
			}
		}
		else = {
			event_target:agenda_province = {
				area_for_scope_province = {
					type = all
					OR = {
						owned_by = root
						owner = {
							is_subject_of = root
						}
					}
				}
			}
		}
	}
	fail_if = {
		event_target:agenda_province = {
			area_for_scope_province = {
				type = all
				NOT = { is_claim = root }
				NOT = { is_core = root }
				NOT = { owned_by = root }
			}
		}
	}
	task_completed_effect = {
		on_completed_agenda_effect = {
			estate = estate_lorentish_elite
		}
		add_estate_loyalty = {
			estate = estate_lorentish_elite
			loyalty = 15
		}
		add_adm_power = 50
	}
	failing_effect = {
		on_failed_agenda_effect = yes
		clr_auto_complete_flag = yes
		add_estate_loyalty_modifier = {
			estate = estate_lorentish_elite
			desc = EST_VAL_AGENDA_DENIED
			loyalty = -5
			duration = 7300
		}
		if = {
			limit = {
				event_target:agenda_province = {
					area_for_scope_province = {
						is_claim = root
						NOT = { is_permanent_claim = root }
					}
				}
			}
			event_target:agenda_province = {
				area = {
					limit = {
						is_claim = root
						NOT = { is_permanent_claim = root }
					}
					remove_claim = root
				}
			}
		}
	}
}

estate_lorentish_elite_annex_subject = {
	can_select = {
		is_at_war = no
		diplomatic_reputation = 0
		any_subject_country = {
			capital_scope = {
				OR = {
					region = lencenor_region
					region = west_dameshead_region
					region = small_country_region
					region = dragon_coast_region
				}
			}
			NOT = { total_development = 300 }
			OR = {
				AND = {
					is_vassal = yes
					years_in_vassalage_under = {
						who = root
						years = 10
					}
				}
				AND = {
					is_lesser_in_union = yes
					years_in_union_under = {
						who = root
						years = 50
					}
				}
			}
		}
		NOT = { tag = Y63 }
	}
	selection_weight = {
		factor = 3
	}
	pre_effect = {
		random_subject_country = {
			limit = {
				capital_scope = {
					OR = {
						region = lencenor_region
						region = west_dameshead_region
						region = small_country_region
						region = dragon_coast_region
					}
				}
				NOT = { total_development = 300 }
				OR = {
					AND = {
						is_vassal = yes
						years_in_vassalage_under = {
							who = root
							years = 10
						}
					}
					AND = {
						is_lesser_in_union = yes
						years_in_union_under = {
							who = root
							years = 50
						}
					}
				}
			}
			save_event_target_as = agenda_country
			capital_scope = {
				save_event_target_as = agenda_province
			}
			add_country_modifier = {
				name = to_be_agenda_annexed_timer
				duration = 7300
				hidden = yes
			}
		}
	}
	provinces_to_highlight = {
		OR = {
			province_id = event_target:agenda_province
			owned_by = event_target:agenda_country
		}
	}
	task_requirements = {
		if = {
			limit = {
				has_estate_agenda_auto_completion = {
					estate = estate_lorentish_elite
				}
			}
			has_estate_agenda_auto_completion = {
				estate = estate_lorentish_elite
			}
		}
		else = {
			event_target:agenda_country = {
				NOT = { num_of_cities = 1 }
			}
			event_target:agenda_province = {
				OR = {
					owned_by = ROOT  
					owner = { is_colonial_nation_of = ROOT }
				}
			}
		}
	}
	fail_if = {
		OR = {
			AND = {
				event_target:agenda_country = {
					NOT = { num_of_cities = 1 }
				}
				if = { 
					limit = {
						event_target:agenda_country = { 
							capital_scope = { 
								NOT = { 
									OR = {
										continent = north_america 
										continent = south_america 
									}
								}
							}
						}
					}
					NOT = {
						event_target:agenda_province = {
							owned_by = root
						}
					}
				}
				else = {
					NOT = {
						event_target:agenda_province = {
							OR = {
								owner = { is_colonial_nation_of = ROOT }
								owned_by = root
							}
						}
					}
				}
			}
			event_target:agenda_country = {
				num_of_cities = 1
				NOT = { is_subject_of = root }
			}
		}
	}
	task_completed_effect = {
		on_completed_agenda_effect = {
			estate = estate_lorentish_elite
		}
		add_estate_loyalty = {
			estate = estate_lorentish_elite
			loyalty = 10
		}
		custom_tooltip = no_penalties_annexing_tt
	}
	failing_effect = {
		on_failed_agenda_effect = yes
		clr_auto_complete_flag = yes
		add_estate_loyalty_modifier = {
			estate = estate_lorentish_elite
			desc = EST_VAL_AGENDA_DENIED
			loyalty = -5
			duration = 7300
		}
		hidden_effect = {
			event_target:agenda_country = {
				remove_country_modifier = to_be_agenda_annexed_timer
			}
		}
	}
}

estate_lorentish_elite_build_an_army = {
	can_select = {
		NOT = { has_country_modifier = thriving_arms_industry }
		NOT = { cavalry_fraction = 0.25 }
	}
	selection_weight = {
		factor = 5
		modifier = {
			factor = 2
			any_rival_country = {
				NOT = { truce_with = root }
				army_size = root
			}
		}
		modifier = {
			factor = 2.0
			NOT = { cavalry_fraction = 0.05 }
		}
		modifier = { #this could be really annoying in the late game
			factor = 0.5
			NOT = { cavalry_fraction = 0.20 }
		}
		modifier = {
			factor = 0.25
			NOT = { cavalry_fraction = 0.15 }
		}
	}
	task_requirements = {
		if = {
			limit = {
				has_estate_agenda_auto_completion = {
					estate = estate_lorentish_elite
				}
			}
			has_estate_agenda_auto_completion = {
				estate = estate_lorentish_elite
			}
		}
		else = {
			cavalry_fraction = 0.3
		}
	}
	task_completed_effect = {
		on_completed_agenda_effect = {
			estate = estate_lorentish_elite
		}
		add_estate_loyalty = {
			estate = estate_lorentish_elite
			loyalty = 10
		}
		create_general = {
			tradition = 60
		}
	}
	failing_effect = {
		on_failed_agenda_effect = yes
		clr_auto_complete_flag = yes
		add_estate_loyalty_modifier = {
			estate = estate_lorentish_elite
			desc = EST_VAL_AGENDA_DENIED
			loyalty = -5
			duration = 7300
		}
	}
}


